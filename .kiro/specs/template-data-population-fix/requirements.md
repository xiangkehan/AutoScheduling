# 需求文档

## 简介

本功能修复一个关键缺陷：当应用排班模版时，可用人员、岗位和约束没有正确填充。目前，当用户在排班向导中应用模版时，约束数据（节假日配置、固定岗位规则和手动指定）没有被加载，导致排班配置不完整。

## 术语表

- **排班系统**：负责创建和管理工作排班的应用程序组件
- **模版**：保存的配置，包含人员、岗位和约束设置，可重复使用
- **约束数据**：影响排班的节假日配置、固定岗位规则和手动指定
- **排班向导**：用于创建新排班的多步骤界面
- **可用列表**：系统中所有可用人员、岗位和约束的集合

## 需求

### 需求 1

**用户故事：** 作为排班员，我希望应用模版时所有模版数据都能正确加载，以便我可以立即进行排班而不会遗漏配置。

#### 验收标准

1. WHEN 排班系统应用模版时，THE 排班系统 SHALL 加载所有约束数据，包括节假日配置、固定岗位规则和手动指定
2. WHEN 排班系统应用模版时，THE 排班系统 SHALL 使用模版中的所有人员ID填充已选人员列表
3. WHEN 排班系统应用模版时，THE 排班系统 SHALL 使用模版中的所有岗位ID填充已选岗位列表
4. WHEN 排班系统应用模版时，THE 排班系统 SHALL 根据模版中启用的约束ID启用相应的约束
5. WHEN 排班系统完成模版加载时，THE 排班系统 SHALL 显示成功消息，确认所有数据已加载

### 需求 2

**用户故事：** 作为排班员，我希望系统在应用模版前验证模版数据是否存在，以便我能收到任何缺失或已删除资源的通知。

#### 验收标准

1. WHEN 排班系统加载模版时，THE 排班系统 SHALL 验证所有引用的人员ID是否存在于可用列表中
2. WHEN 排班系统加载模版时，THE 排班系统 SHALL 验证所有引用的岗位ID是否存在于可用列表中
3. IF 模版中的任何人员或岗位不再存在，THEN 排班系统 SHALL 显示警告消息，列出缺失的资源
4. WHEN 排班系统检测到缺失资源时，THE 排班系统 SHALL 仍然加载模版，但仅包含可用的资源
5. WHEN 排班系统加载约束数据时，THE 排班系统 SHALL 根据选定的日期范围过滤约束

### 需求 3

**用户故事：** 作为排班员，我希望向导能正确处理基于模版的工作流，以便我可以高效地创建排班而无需浏览不必要的步骤。

#### 验收标准

1. WHEN 应用模版时，THE 排班向导 SHALL 允许从第1步直接导航到第5步
2. WHEN 应用模版时，THE 排班向导 SHALL 确保在允许执行前加载所有必需数据
3. WHEN 用户使用已应用的模版导航到第5步时，THE 排班向导 SHALL 显示完整摘要，包括所有人员、岗位和约束
4. WHEN 用户使用已应用的模版执行排班时，THE 排班系统 SHALL 在排班请求中包含所有模版配置的约束
5. WHEN 用户取消向导时，THE 排班系统 SHALL 清除所有模版应用状态和已加载数据
