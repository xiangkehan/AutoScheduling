# AutoScheduling3 è‡ªåŠ¨æ’ç­ç³»ç»Ÿ UI è®¾è®¡æ–¹æ¡ˆ

## ä¸€ã€è®¾è®¡æ¦‚è§ˆ

### 1.1 è®¾è®¡åŸåˆ™

æœ¬è®¾è®¡æ–¹æ¡ˆéµå¾ª WinUI 3 è§„èŒƒå’Œ Windows 11 è®¾è®¡è¯­è¨€ï¼ˆFluent Design Systemï¼‰ï¼Œå®ç°å‰åç«¯å®Œå…¨åˆ†ç¦»çš„æ¡Œé¢åº”ç”¨ç•Œé¢ã€‚

**æ ¸å¿ƒè®¾è®¡ç†å¿µ**ï¼š
- **æµç•…æ€§ï¼ˆFluencyï¼‰**ï¼šä½¿ç”¨ Acrylic æè´¨ã€åŠ¨ç”»è¿‡æ¸¡å’Œå¾®äº¤äº’å¢å¼ºç”¨æˆ·ä½“éªŒ
- **é€‚åº”æ€§ï¼ˆAdaptabilityï¼‰**ï¼šæ”¯æŒäº®è‰²/æš—è‰²ä¸»é¢˜ï¼Œå“åº”å¼å¸ƒå±€
- **æ¸…æ™°æ€§ï¼ˆClarityï¼‰**ï¼šä¿¡æ¯å±‚çº§åˆ†æ˜ï¼Œå¯¼èˆªè·¯å¾„æ¸…æ™°
- **é«˜æ•ˆæ€§ï¼ˆEfficiencyï¼‰**ï¼šå‡å°‘æ“ä½œæ­¥éª¤ï¼Œæä¾›å¿«æ·æ“ä½œå…¥å£

**å‰åç«¯åˆ†ç¦»æ¶æ„**ï¼š
- å‰ç«¯ï¼šWinUI 3 æ¡Œé¢åº”ç”¨ï¼Œè´Ÿè´£ UI å‘ˆç°å’Œç”¨æˆ·äº¤äº’
- åç«¯ï¼šWeb API æœåŠ¡ï¼ˆASP.NET Coreï¼‰ï¼Œæä¾› RESTful æ¥å£
- é€šä¿¡ï¼šHTTP/HTTPS + JSON æ•°æ®æ ¼å¼
- çŠ¶æ€ç®¡ç†ï¼šå‰ç«¯ä½¿ç”¨ MVVM æ¨¡å¼ï¼Œåç«¯æ— çŠ¶æ€è®¾è®¡

### 1.2 æŠ€æœ¯æ ˆ

| å±‚çº§ | æŠ€æœ¯é€‰å‹ | è¯´æ˜ |
|------|---------|------|
| å‰ç«¯æ¡†æ¶ | WinUI 3 | Windows åº”ç”¨ SDKï¼ŒåŸç”Ÿ Windows 11 ä½“éªŒ |
| UI æ¶æ„ | MVVMï¼ˆCommunityToolkit.Mvvmï¼‰ | è§†å›¾æ¨¡å‹åˆ†ç¦»ï¼Œæ•°æ®ç»‘å®š |
| å¯¼èˆªç³»ç»Ÿ | NavigationView + Frame | Win11 æ ‡å‡†å¯¼èˆªæ¨¡å¼ |
| HTTP å®¢æˆ·ç«¯ | HttpClient + System.Text.Json | RESTful API è°ƒç”¨ |
| åç«¯æ¡†æ¶ | ASP.NET Core Web API | è·¨å¹³å°ã€é«˜æ€§èƒ½ API æœåŠ¡ |
| æ•°æ®æŒä¹…åŒ– | SQLite + Entity Framework Core | è½»é‡çº§æ•°æ®åº“ |
| æ¥å£æ–‡æ¡£ | OpenAPI (Swagger) | è‡ªåŠ¨ç”Ÿæˆ API æ–‡æ¡£ |

### 1.3 åº”ç”¨ç»“æ„

```mermaid
graph TB
    subgraph "å‰ç«¯åº”ç”¨ WinUI 3"
        A[Shell ä¸»çª—å£] --> B[NavigationView å¯¼èˆªå®¹å™¨]
        B --> C1[æ•°æ®ç®¡ç†é¡µé¢]
        B --> C2[æ’ç­ç®¡ç†é¡µé¢]
        B --> C3[å†å²è®°å½•é¡µé¢]
        
        C1 --> D1[äººå‘˜ç®¡ç†]
        C1 --> D2[å“¨ä½ç®¡ç†]
        C1 --> D3[æŠ€èƒ½ç®¡ç†]
        C1 --> D4[çº¦æŸé…ç½®]
        
        C2 --> E1[æ–°å»ºæ’ç­]
        C2 --> E2[æ’ç­ç»“æœ]
        C2 --> E3[ä¼˜åŒ–è°ƒæ•´]
        
        C3 --> F1[å†å²åˆ—è¡¨]
        C3 --> F2[è¯¦æƒ…æŸ¥çœ‹]
    end
    
    subgraph "API æœåŠ¡å±‚"
        G[API Gateway] --> H1[äººå‘˜æœåŠ¡ API]
        G --> H2[å“¨ä½æœåŠ¡ API]
        G --> H3[æŠ€èƒ½æœåŠ¡ API]
        G --> H4[çº¦æŸæœåŠ¡ API]
        G --> H5[æ’ç­æœåŠ¡ API]
        G --> H6[å†å²æœåŠ¡ API]
    end
    
    subgraph "æ•°æ®å±‚"
        I[SQLite æ•°æ®åº“]
        H1 --> I
        H2 --> I
        H3 --> I
        H4 --> I
        H5 --> I
        H6 --> I
    end
    
    A -.HTTP/JSON.-> G
```

## äºŒã€ä¸»ç•Œé¢æ¡†æ¶è®¾è®¡

### 2.1 Shell ä¸»çª—å£ç»“æ„

**å¸ƒå±€ç»„æˆ**ï¼š
- æ ‡é¢˜æ ï¼šè‡ªå®šä¹‰æ ‡é¢˜æ ï¼Œé›†æˆæœç´¢æ¡†å’Œç”¨æˆ·èœå•
- å¯¼èˆªé¢æ¿ï¼šå·¦ä¾§ NavigationViewï¼Œæ”¯æŒå±•å¼€/æŠ˜å 
- å†…å®¹åŒºåŸŸï¼šFrame æ‰¿è½½é¡µé¢å†…å®¹
- çŠ¶æ€æ ï¼šæ˜¾ç¤ºç³»ç»ŸçŠ¶æ€ã€é€šçŸ¥å’Œè¿›åº¦

**è§†è§‰å±‚çº§**ï¼š
| å…ƒç´  | å±‚çº§ | æè´¨æ•ˆæœ | ç”¨é€” |
|------|------|---------|------|
| æ ‡é¢˜æ  | Z-Index: 100 | Mica èƒŒæ™¯ | åº”ç”¨æ ‡è¯†ã€å…¨å±€æ“ä½œ |
| å¯¼èˆªé¢æ¿ | Z-Index: 90 | Acrylic äºšå…‹åŠ› | é¡µé¢å¯¼èˆª |
| å†…å®¹åŒºåŸŸ | Z-Index: 10 | çº¯è‰²èƒŒæ™¯ | ä¸»è¦å†…å®¹å±•ç¤º |
| å¼¹å‡ºå±‚ | Z-Index: 200 | æ¨¡ç³ŠèƒŒæ™¯ | å¯¹è¯æ¡†ã€èœå• |
| çŠ¶æ€æ  | Z-Index: 80 | åŠé€æ˜èƒŒæ™¯ | çŠ¶æ€ä¿¡æ¯ |

### 2.2 å¯¼èˆªç»“æ„

```mermaid
graph LR
    A[å¯¼èˆªæ ¹] --> B[æ•°æ®ç®¡ç†]
    A --> C[æ’ç­ç®¡ç†]
    A --> D[å†å²è®°å½•]
    A --> E[è®¾ç½®]
    
    B --> B1[äººå‘˜]
    B --> B2[å“¨ä½]
    B --> B3[æŠ€èƒ½]
    B --> B4[çº¦æŸ]
    
    C --> C1[åˆ›å»ºæ’ç­]
    C --> C2[æ’ç­è‰ç¨¿]
    C --> C3[ä¼˜åŒ–å·¥å…·]
    
    D --> D1[å·²ç¡®è®¤æ’ç­]
    D --> D2[è‰ç¨¿ç®±]
    
    E --> E1[å¤–è§‚]
    E --> E2[API é…ç½®]
    E --> E3[å…³äº]
```

**å¯¼èˆªèœå•é¡¹å®šä¹‰**ï¼š

| å›¾æ ‡ | æ ‡é¢˜ | è·¯ç”± | æƒé™ | è¯´æ˜ |
|------|------|------|------|------|
| ğŸ“Š | æ•°æ®ç®¡ç† | /data-management | åŸºç¡€ | äººå‘˜ã€å“¨ä½ã€æŠ€èƒ½ã€çº¦æŸç®¡ç† |
| ğŸ“… | æ’ç­ç®¡ç† | /scheduling | åŸºç¡€ | åˆ›å»ºå’Œä¼˜åŒ–æ’ç­ |
| ğŸ“œ | å†å²è®°å½• | /history | åŸºç¡€ | æŸ¥çœ‹å†å²æ’ç­ |
| âš™ï¸ | è®¾ç½® | /settings | åŸºç¡€ | åº”ç”¨é…ç½® |

### 2.3 ä¸»é¢˜ä¸é…è‰²

**Win11 è‰²å½©ç³»ç»Ÿ**ï¼š

| ä¸»é¢˜ | èƒŒæ™¯è‰² | å¡ç‰‡è‰² | å¼ºè°ƒè‰² | æ–‡æœ¬è‰² | è¾¹æ¡†è‰² |
|------|--------|--------|--------|--------|--------|
| æµ…è‰²æ¨¡å¼ | #F3F3F3 | #FFFFFF | SystemAccentColor | #000000 (E1) | #E5E5E5 |
| æ·±è‰²æ¨¡å¼ | #202020 | #2C2C2C | SystemAccentColorLight1 | #FFFFFF (E1) | #3F3F3F |

**è¯­ä¹‰è‰²å½©**ï¼š

| ç”¨é€” | æµ…è‰²æ¨¡å¼ | æ·±è‰²æ¨¡å¼ | ä½¿ç”¨åœºæ™¯ |
|------|---------|---------|---------|
| æˆåŠŸ | #107C10 | #6CCB5F | æ“ä½œæˆåŠŸæç¤º |
| è­¦å‘Š | #FFB900 | #FCE100 | çº¦æŸå†²çªæç¤º |
| é”™è¯¯ | #E81123 | #FF99A4 | é”™è¯¯ä¿¡æ¯ |
| ä¿¡æ¯ | #0078D4 | #60CDFF | ä¸€èˆ¬æç¤º |

## ä¸‰ã€æ ¸å¿ƒé¡µé¢è®¾è®¡

### 3.1 æ•°æ®ç®¡ç†æ¨¡å—

#### 3.1.1 äººå‘˜ç®¡ç†é¡µé¢

**é¡µé¢è·¯å¾„**ï¼š`/data-management/personnel`

**å¸ƒå±€ç»“æ„**ï¼š

```mermaid
graph TB
    A[äººå‘˜ç®¡ç†é¡µé¢å®¹å™¨] --> B[é¡¶éƒ¨å‘½ä»¤æ ]
    A --> C[ä¸»å†…å®¹åŒº - åˆ†æ å¸ƒå±€]
    
    B --> B1[æ–°å¢äººå‘˜æŒ‰é’®]
    B --> B2[æ‰¹é‡å¯¼å…¥æŒ‰é’®]
    B --> B3[å¯¼å‡ºæŒ‰é’®]
    B --> B4[æœç´¢æ¡†]
    
    C --> D[å·¦ä¾§ - äººå‘˜åˆ—è¡¨]
    C --> E[å³ä¾§ - è¯¦æƒ…é¢æ¿]
    
    D --> D1[ç­›é€‰æ ‡ç­¾æ ]
    D --> D2[äººå‘˜å¡ç‰‡åˆ—è¡¨]
    D --> D3[åˆ†é¡µæ§ä»¶]
    
    E --> E1[äººå‘˜åŸºæœ¬ä¿¡æ¯è¡¨å•]
    E --> E2[æŠ€èƒ½é…ç½®åŒºåŸŸ]
    E --> E3[ç­æ¬¡ç»Ÿè®¡åŒºåŸŸ]
    E --> E4[æ“ä½œæŒ‰é’®ç»„]
```

**å·¦ä¾§äººå‘˜åˆ—è¡¨**ï¼š

| æ§ä»¶ç±»å‹ | ç”¨é€” | æ•°æ®ç»‘å®š | äº¤äº’è¡Œä¸º |
|---------|------|---------|---------|
| SplitButtonï¼ˆç­›é€‰ï¼‰ | å¿«é€Ÿç­›é€‰ | åœ¨èŒ/é€€å½¹çŠ¶æ€ | ç‚¹å‡»åˆ‡æ¢ç­›é€‰æ¡ä»¶ |
| SearchBox | æœç´¢äººå‘˜ | å§“åã€èŒä½å…³é”®è¯ | å®æ—¶æœç´¢ |
| ListView | äººå‘˜åˆ—è¡¨ | PersonnelViewModel.Personnel | å•é€‰ï¼Œç‚¹å‡»æ˜¾ç¤ºè¯¦æƒ… |
| Pagination | åˆ†é¡µå¯¼èˆª | å½“å‰é¡µ/æ€»é¡µæ•° | åˆ‡æ¢é¡µé¢ |

**äººå‘˜å¡ç‰‡å†…å®¹ç»“æ„**ï¼š
- å¤´åƒåŒºåŸŸï¼šæ˜¾ç¤ºäººå‘˜å¤´åƒï¼ˆæˆ–é¦–å­—æ¯ï¼‰
- åŸºç¡€ä¿¡æ¯ï¼šå§“åï¼ˆç²—ä½“ï¼‰ã€èŒä½ï¼ˆæ¬¡è¦æ–‡æœ¬ï¼‰
- çŠ¶æ€æ ‡è®°ï¼šåœ¨èŒ/é€€å½¹ Badgeã€å¯ç”¨æ€§æŒ‡ç¤ºå™¨
- å¿«æ·æ“ä½œï¼šç¼–è¾‘å›¾æ ‡æŒ‰é’®ã€åˆ é™¤å›¾æ ‡æŒ‰é’®

**å³ä¾§è¯¦æƒ…é¢æ¿**ï¼š

**è¡¨å•å­—æ®µå®šä¹‰**ï¼š

| å­—æ®µåç§° | æ§ä»¶ç±»å‹ | éªŒè¯è§„åˆ™ | API å­—æ®µ |
|---------|---------|---------|---------|
| å§“å | TextBox | å¿…å¡«ï¼Œ1-50å­—ç¬¦ | Name |
| èŒä½ | ComboBox | å¿…é€‰ï¼Œå…³è”å“¨ä½æ•°æ® | PositionId |
| æ˜¯å¦åœ¨èŒ | ToggleSwitch | å¸ƒå°”å€¼ | IsRetiredï¼ˆå–åï¼‰ |
| æ˜¯å¦å¯ç”¨ | ToggleSwitch | å¸ƒå°”å€¼ | IsAvailable |
| æŠ€èƒ½åˆ—è¡¨ | CheckBox ç»„ | è‡³å°‘é€‰æ‹©ä¸€é¡¹ | SkillIds |
| æœ€è¿‘ç­æ¬¡é—´éš” | NumberBox | 0-999ï¼Œæ•´æ•° | RecentShiftIntervalCount |
| èŠ‚å‡æ—¥ç­æ¬¡é—´éš” | NumberBox | 0-999ï¼Œæ•´æ•° | RecentHolidayShiftIntervalCount |
| æ—¶æ®µç­æ¬¡é—´éš” | NumberBox[12] | 0-999ï¼Œæ•°ç»„ | RecentPeriodShiftIntervals |

**æŠ€èƒ½é…ç½®åŒºåŸŸ**ï¼š
- ä½¿ç”¨ ItemsRepeater æ˜¾ç¤ºæŠ€èƒ½åˆ—è¡¨
- æ¯é¡¹æŠ€èƒ½ä½¿ç”¨ CheckBox + æŠ€èƒ½åç§°æ ‡ç­¾
- æ”¯æŒå…¨é€‰/åé€‰å¿«æ·æ“ä½œ

**ç­æ¬¡ç»Ÿè®¡åŒºåŸŸ**ï¼š
- ä½¿ç”¨ Expander æŠ˜å é¢æ¿
- æ˜¾ç¤º 12 ä¸ªæ—¶æ®µçš„ç­æ¬¡é—´éš”æ•°æ®
- ä½¿ç”¨ Grid å¸ƒå±€ï¼Œæ¯è¡Œ 4 ä¸ªæ—¶æ®µ

**API äº¤äº’æµç¨‹**ï¼š

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant V as PersonnelViewModel
    participant A as PersonnelApiService
    participant S as åç«¯ API Server
    
    U->>V: æ‰“å¼€äººå‘˜ç®¡ç†é¡µé¢
    V->>A: GetAllPersonnelsAsync()
    A->>S: GET /api/personnel
    S-->>A: PersonnelList JSON
    A-->>V: List<PersonnelDto>
    V->>V: ç»‘å®šåˆ° ObservableCollection
    
    U->>V: ç‚¹å‡»"æ–°å¢äººå‘˜"
    V->>V: æ‰“å¼€ç¼–è¾‘å¯¹è¯æ¡†ï¼ˆç©ºè¡¨å•ï¼‰
    U->>V: å¡«å†™è¡¨å•å¹¶ä¿å­˜
    V->>V: éªŒè¯è¡¨å•æ•°æ®
    V->>A: CreatePersonnelAsync(dto)
    A->>S: POST /api/personnel
    S-->>A: CreatedPersonnel JSON (å« Id)
    A-->>V: PersonnelDto
    V->>V: æ·»åŠ åˆ°åˆ—è¡¨å¹¶åˆ·æ–°
    V->>U: æ˜¾ç¤ºæˆåŠŸæç¤º
```

#### 3.1.2 å“¨ä½ç®¡ç†é¡µé¢

**é¡µé¢è·¯å¾„**ï¼š`/data-management/positions`

**å¸ƒå±€ç»“æ„**ï¼šä¸äººå‘˜ç®¡ç†ç±»ä¼¼çš„ä¸»-ä»å¸ƒå±€

**å·¦ä¾§å“¨ä½åˆ—è¡¨**ï¼š
- ç½‘æ ¼å¡ç‰‡è§†å›¾ï¼ˆGridViewï¼‰ï¼Œæ˜¾ç¤ºå“¨ä½å¡ç‰‡
- æ”¯æŒåˆ—è¡¨/ç½‘æ ¼è§†å›¾åˆ‡æ¢
- æ¯å¼ å¡ç‰‡æ˜¾ç¤ºï¼šå“¨ä½åç§°ã€åœ°ç‚¹ã€æŠ€èƒ½æ ‡ç­¾ã€å¿«æ·æ“ä½œ

**å³ä¾§è¯¦æƒ…é¢æ¿å­—æ®µ**ï¼š

| å­—æ®µåç§° | æ§ä»¶ç±»å‹ | éªŒè¯è§„åˆ™ | API å­—æ®µ |
|---------|---------|---------|---------|
| å“¨ä½åç§° | TextBox | å¿…å¡«ï¼Œ1-100å­—ç¬¦ | Name |
| åœ°ç‚¹ | TextBox | å¿…å¡«ï¼Œ1-200å­—ç¬¦ | Location |
| ä»‹ç» | TextBoxï¼ˆå¤šè¡Œï¼‰ | å¯é€‰ï¼Œæœ€å¤š500å­—ç¬¦ | Description |
| è¦æ±‚è¯´æ˜ | RichEditBox | å¯é€‰ï¼Œæ”¯æŒæ ¼å¼åŒ– | Requirements |
| æ‰€éœ€æŠ€èƒ½ | CheckBox ç»„ | è‡³å°‘é€‰æ‹©ä¸€é¡¹ | RequiredSkillIds |

**å“¨ä½å¡ç‰‡è§†è§‰è®¾è®¡**ï¼š
- ä½¿ç”¨ CardPanel å®¹å™¨ï¼ˆåœ†è§’ã€é˜´å½±ï¼‰
- é¡¶éƒ¨ï¼šå“¨ä½åç§°ï¼ˆ18px ç²—ä½“ï¼‰
- ä¸­é—´ï¼šåœ°ç‚¹å›¾æ ‡ + åœ°ç‚¹æ–‡æœ¬
- åº•éƒ¨ï¼šæŠ€èƒ½æ ‡ç­¾ï¼ˆChip é£æ ¼ï¼‰
- Hover æ•ˆæœï¼šè½»å¾®ä¸Šæµ® + é˜´å½±åŠ æ·±

#### 3.1.3 æŠ€èƒ½ç®¡ç†é¡µé¢

**é¡µé¢è·¯å¾„**ï¼š`/data-management/skills`

**å¸ƒå±€æ¨¡å¼**ï¼šç®€åŒ–çš„åˆ—è¡¨ + å†…è”ç¼–è¾‘æ¨¡å¼

**åˆ—è¡¨è§†å›¾**ï¼š

| åˆ—å | å®½åº¦ | å†…å®¹ | å¯æ’åº |
|------|------|------|--------|
| ID | 60px | æŠ€èƒ½ ID | æ˜¯ |
| æŠ€èƒ½åç§° | 200px | TextBoxï¼ˆå¯ç¼–è¾‘ï¼‰ | æ˜¯ |
| æè¿° | * | TextBoxï¼ˆå¯ç¼–è¾‘ï¼‰ | å¦ |
| æ“ä½œ | 100px | ä¿å­˜/åˆ é™¤æŒ‰é’® | å¦ |

**å†…è”ç¼–è¾‘æ¨¡å¼**ï¼š
- ç‚¹å‡»è¡Œè¿›å…¥ç¼–è¾‘çŠ¶æ€ï¼Œæ§ä»¶å˜ä¸ºå¯ç¼–è¾‘
- ä¿å­˜æŒ‰é’®ï¼šè°ƒç”¨ API æ›´æ–°æ•°æ®
- å–æ¶ˆæŒ‰é’®ï¼šæ¢å¤åŸå§‹æ•°æ®
- åˆ é™¤æŒ‰é’®ï¼šå¼¹å‡ºç¡®è®¤å¯¹è¯æ¡†

**æ–°å¢æŠ€èƒ½**ï¼š
- é¡¶éƒ¨å›ºå®šä¸€è¡Œ"æ–°å¢æŠ€èƒ½"è¡¨å•
- è¾“å…¥åç§°å’Œæè¿°åç‚¹å‡»"æ·»åŠ "æŒ‰é’®
- ç«‹å³è°ƒç”¨ API åˆ›å»ºå¹¶åˆ·æ–°åˆ—è¡¨

#### 3.1.4 çº¦æŸé…ç½®é¡µé¢

**é¡µé¢è·¯å¾„**ï¼š`/data-management/constraints`

**æ ‡ç­¾é¡µç»“æ„**ï¼š

```mermaid
graph LR
    A[çº¦æŸé…ç½®] --> B[ä¼‘æ¯æ—¥é…ç½®]
    A --> C[å®šå²—è§„åˆ™]
    A --> D[æ‰‹åŠ¨æŒ‡å®š]
    
    B --> B1[å‘¨æœ«è®¾ç½®]
    B --> B2[æ³•å®šå‡æ—¥]
    B --> B3[è‡ªå®šä¹‰å‡æ—¥]
    
    C --> C1[è§„åˆ™åˆ—è¡¨]
    C --> C2[è§„åˆ™è¯¦æƒ…]
    
    D --> D1[æŒ‡å®šåˆ—è¡¨]
    D --> D2[æ—¥å†è§†å›¾]
```

**ä¼‘æ¯æ—¥é…ç½®æ ‡ç­¾é¡µ**ï¼š

**å­—æ®µè®¾è®¡**ï¼š

| é…ç½®é¡¹ | æ§ä»¶ç±»å‹ | è¯´æ˜ | API å­—æ®µ |
|--------|---------|------|---------|
| é…ç½®åç§° | TextBox | å¦‚"2024å¹´é…ç½®" | ConfigName |
| å¯ç”¨å‘¨æœ«è§„åˆ™ | ToggleSwitch | æ˜¯å¦å¯ç”¨ | EnableWeekendRule |
| å‘¨æœ«æ—¥æœŸé€‰æ‹© | CheckBox ç»„ | å‘¨ä¸€åˆ°å‘¨æ—¥å¤šé€‰ | WeekendDays |
| æ³•å®šå‡æ—¥åˆ—è¡¨ | CalendarDatePicker + ListView | æ—¥æœŸåˆ—è¡¨ | LegalHolidays |
| è‡ªå®šä¹‰å‡æ—¥åˆ—è¡¨ | CalendarDatePicker + ListView | æ—¥æœŸåˆ—è¡¨ | CustomHolidays |
| æ’é™¤æ—¥æœŸåˆ—è¡¨ | CalendarDatePicker + ListView | å¼ºåˆ¶å·¥ä½œæ—¥ | ExcludedDates |
| æ˜¯å¦å¯ç”¨ | ToggleSwitch | å½“å‰æ´»åŠ¨é…ç½® | IsActive |

**æ—¥æœŸåˆ—è¡¨æ“ä½œ**ï¼š
- ä½¿ç”¨ CalendarDatePicker é€‰æ‹©æ—¥æœŸ
- ç‚¹å‡»"æ·»åŠ "æŒ‰é’®åŠ å…¥åˆ—è¡¨
- ListView æ˜¾ç¤ºå·²æ·»åŠ æ—¥æœŸï¼Œå¸¦åˆ é™¤æŒ‰é’®
- æ”¯æŒæ‰¹é‡å¯¼å…¥ï¼ˆä»æ–‡ä»¶æˆ–å‰ªè´´æ¿ï¼‰

**å®šå²—è§„åˆ™æ ‡ç­¾é¡µ**ï¼š

**åˆ—è¡¨æ˜¾ç¤º**ï¼š
- å·¦ä¾§ï¼šè§„åˆ™åˆ—è¡¨ï¼ˆListBoxï¼‰
- å³ä¾§ï¼šè§„åˆ™è¯¦æƒ…ç¼–è¾‘é¢æ¿

**è§„åˆ™è¡¨å•å­—æ®µ**ï¼š

| å­—æ®µåç§° | æ§ä»¶ç±»å‹ | éªŒè¯è§„åˆ™ | API å­—æ®µ |
|---------|---------|---------|---------|
| è§„åˆ™åç§° | TextBox | å¿…å¡« | RuleName |
| äººå‘˜ | ComboBox | å¿…é€‰ | PersonalId |
| å…è®¸å“¨ä½ | CheckBox ç»„ | è‡³å°‘ä¸€é¡¹ | AllowedPositionIds |
| å…è®¸æ—¶æ®µ | CheckBox ç»„ï¼ˆ12ä¸ªï¼‰ | å¯ç©º | AllowedPeriods |
| æ˜¯å¦å¯ç”¨ | ToggleSwitch | å¸ƒå°”å€¼ | IsEnabled |

**æ‰‹åŠ¨æŒ‡å®šæ ‡ç­¾é¡µ**ï¼š

**å¸ƒå±€æ–¹å¼**ï¼š
- é¡¶éƒ¨ï¼šæ—¥æœŸèŒƒå›´é€‰æ‹©å™¨ï¼ˆæ˜¾ç¤ºæŒ‡å®šçš„æ—¶é—´èŒƒå›´ï¼‰
- ä¸­é—´ï¼šæ—¥å†è§†å›¾ + æŒ‡å®šåˆ—è¡¨åŒè§†å›¾
- åº•éƒ¨ï¼šæ–°å¢æŒ‡å®šæŒ‰é’®

**æ—¥å†è§†å›¾**ï¼š
- ä½¿ç”¨ CalendarView æ§ä»¶
- å·²æŒ‡å®šæ—¥æœŸé«˜äº®æ˜¾ç¤ºï¼ˆä¸åŒé¢œè‰²è¡¨ç¤ºä¸åŒå“¨ä½ï¼‰
- ç‚¹å‡»æ—¥æœŸæ˜¾ç¤ºè¯¥æ—¥æ‰€æœ‰æŒ‡å®š

**æŒ‡å®šè¡¨å•å­—æ®µ**ï¼š

| å­—æ®µåç§° | æ§ä»¶ç±»å‹ | éªŒè¯è§„åˆ™ | API å­—æ®µ |
|---------|---------|---------|---------|
| æ—¥æœŸ | CalendarDatePicker | å¿…é€‰ | Date |
| æ—¶æ®µ | ComboBoxï¼ˆ12é€‰1ï¼‰ | å¿…é€‰ | Period |
| å“¨ä½ | ComboBox | å¿…é€‰ | PositionId |
| äººå‘˜ | ComboBox | å¿…é€‰ | PersonalId |
| æ˜¯å¦å¯ç”¨ | ToggleSwitch | å¸ƒå°”å€¼ | IsEnabled |

### 3.2 æ’ç­ç®¡ç†æ¨¡å—

#### 3.2.1 åˆ›å»ºæ’ç­é¡µé¢

**é¡µé¢è·¯å¾„**ï¼š`/scheduling/create`

**åˆ†æ­¥å‘å¯¼æµç¨‹**ï¼š

```mermaid
stateDiagram-v2
    [*] --> æ­¥éª¤1_é€‰æ‹©èŒƒå›´
    æ­¥éª¤1_é€‰æ‹©èŒƒå›´ --> æ­¥éª¤2_é€‰æ‹©äººå‘˜
    æ­¥éª¤2_é€‰æ‹©äººå‘˜ --> æ­¥éª¤3_é€‰æ‹©å“¨ä½
    æ­¥éª¤3_é€‰æ‹©å“¨ä½ --> æ­¥éª¤4_é…ç½®çº¦æŸ
    æ­¥éª¤4_é…ç½®çº¦æŸ --> æ­¥éª¤5_ç¡®è®¤å‚æ•°
    æ­¥éª¤5_ç¡®è®¤å‚æ•° --> æ‰§è¡Œæ’ç­
    æ‰§è¡Œæ’ç­ --> æ’ç­ç»“æœ
    æ’ç­ç»“æœ --> [*]
    
    æ­¥éª¤1_é€‰æ‹©èŒƒå›´ --> [*] : å–æ¶ˆ
    æ­¥éª¤2_é€‰æ‹©äººå‘˜ --> æ­¥éª¤1_é€‰æ‹©èŒƒå›´ : ä¸Šä¸€æ­¥
    æ­¥éª¤3_é€‰æ‹©å“¨ä½ --> æ­¥éª¤2_é€‰æ‹©äººå‘˜ : ä¸Šä¸€æ­¥
    æ­¥éª¤4_é…ç½®çº¦æŸ --> æ­¥éª¤3_é€‰æ‹©å“¨ä½ : ä¸Šä¸€æ­¥
    æ­¥éª¤5_ç¡®è®¤å‚æ•° --> æ­¥éª¤4_é…ç½®çº¦æŸ : ä¸Šä¸€æ­¥
```

**æ­¥éª¤è¯¦ç»†è®¾è®¡**ï¼š

**æ­¥éª¤ 1ï¼šé€‰æ‹©æ—¶é—´èŒƒå›´**

| å­—æ®µ | æ§ä»¶ | éªŒè¯ | é»˜è®¤å€¼ |
|------|------|------|--------|
| å¼€å§‹æ—¥æœŸ | CalendarDatePicker | å¿…å¡«ï¼Œä¸æ—©äºä»Šå¤© | ä»Šå¤© |
| ç»“æŸæ—¥æœŸ | CalendarDatePicker | å¿…å¡«ï¼Œä¸æ—©äºå¼€å§‹æ—¥æœŸ | ä»Šå¤©+30å¤© |
| æ’ç­è¡¨åç§° | TextBox | å¿…å¡«ï¼Œ1-100å­—ç¬¦ | "æ’ç­è¡¨_å¹´æœˆæ—¥" |

**æ­¥éª¤ 2ï¼šé€‰æ‹©å‚ä¸äººå‘˜**

- å·¦ä¾§ï¼šå…¨éƒ¨äººå‘˜åˆ—è¡¨ï¼ˆå¸¦æœç´¢å’Œç­›é€‰ï¼‰
- ä¸­é—´ï¼šæ·»åŠ /ç§»é™¤æŒ‰é’®
- å³ä¾§ï¼šå·²é€‰äººå‘˜åˆ—è¡¨
- æ˜¾ç¤ºæ¯ä¸ªäººå‘˜çš„åŸºæœ¬ä¿¡æ¯å’ŒçŠ¶æ€
- æ”¯æŒå¿«æ·é€‰æ‹©ï¼šå…¨é€‰åœ¨èŒã€å…¨é€‰æŸèŒä½

**æ­¥éª¤ 3ï¼šé€‰æ‹©å‚ä¸å“¨ä½**

- å¸ƒå±€åŒæ­¥éª¤ 2
- å·¦ä¾§ï¼šå…¨éƒ¨å“¨ä½åˆ—è¡¨
- å³ä¾§ï¼šå·²é€‰å“¨ä½åˆ—è¡¨
- æ˜¾ç¤ºå“¨ä½çš„æŠ€èƒ½è¦æ±‚
- æ”¯æŒæŒ‰åœ°ç‚¹ç­›é€‰

**æ­¥éª¤ 4ï¼šé…ç½®çº¦æŸ**

| çº¦æŸç±»å‹ | æ§ä»¶ | è¯´æ˜ |
|---------|------|------|
| ä¼‘æ¯æ—¥é…ç½® | ComboBox | é€‰æ‹©å·²ä¿å­˜çš„é…ç½® |
| å®šå²—è§„åˆ™ | CheckBox åˆ—è¡¨ | å¤šé€‰å¯ç”¨çš„è§„åˆ™ |
| æ‰‹åŠ¨æŒ‡å®š | CheckBox åˆ—è¡¨ | å¤šé€‰å¯ç”¨çš„æŒ‡å®š |

**æ­¥éª¤ 5ï¼šç¡®è®¤å¹¶æ‰§è¡Œ**

- æ±‡æ€»æ˜¾ç¤ºæ‰€æœ‰é…ç½®ä¿¡æ¯
- ä½¿ç”¨ InfoBar æ§ä»¶åˆ†ç»„å±•ç¤º
- æä¾›"è¿”å›ä¿®æ”¹"å’Œ"å¼€å§‹æ’ç­"æŒ‰é’®

**æ‰§è¡Œæ’ç­è¿‡ç¨‹**ï¼š

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant V as SchedulingViewModel
    participant A as SchedulingApiService
    participant S as åç«¯ API
    
    U->>V: ç‚¹å‡»"å¼€å§‹æ’ç­"
    V->>V: æ˜¾ç¤ºè¿›åº¦å¯¹è¯æ¡†
    V->>A: ExecuteSchedulingAsync(params)
    A->>S: POST /api/scheduling/execute
    
    Note over S: åç«¯æ‰§è¡Œæ’ç­ç®—æ³•<br/>å¯èƒ½è€—æ—¶æ•°ç§’åˆ°æ•°åˆ†é’Ÿ
    
    S-->>A: ScheduleResult JSON
    A-->>V: ScheduleDto
    V->>V: å…³é—­è¿›åº¦å¯¹è¯æ¡†
    V->>V: å¯¼èˆªåˆ°ç»“æœé¡µé¢
```

**è¿›åº¦å¯¹è¯æ¡†è®¾è®¡**ï¼š
- ä½¿ç”¨ ProgressRingï¼ˆä¸ç¡®å®šè¿›åº¦ï¼‰
- æ˜¾ç¤ºæç¤ºæ–‡æœ¬ï¼š"æ­£åœ¨ç”Ÿæˆæ’ç­ï¼Œè¯·ç¨å€™..."
- æä¾›"åå°è¿è¡Œ"æŒ‰é’®ï¼ˆå¯é€‰ï¼‰

#### 3.2.2 æ’ç­ç»“æœé¡µé¢

**é¡µé¢è·¯å¾„**ï¼š`/scheduling/result/{scheduleId}`

**å¸ƒå±€ç»“æ„**ï¼š

```mermaid
graph TB
    A[æ’ç­ç»“æœé¡µé¢] --> B[é¡¶éƒ¨å·¥å…·æ ]
    A --> C[ä¸»å†…å®¹åŒº]
    A --> D[åº•éƒ¨æ“ä½œæ ]
    
    B --> B1[å¯¼å‡ºæŒ‰é’®]
    B --> B2[è§†å›¾åˆ‡æ¢]
    B --> B3[ç­›é€‰å™¨]
    
    C --> C1[æ’ç­è¡¨ç½‘æ ¼è§†å›¾]
    C --> C2[å†²çªæç¤ºé¢æ¿]
    
    D --> D1[ä¿å­˜è‰ç¨¿]
    D --> D2[ç¡®è®¤æ’ç­]
    D --> D3[é‡æ–°æ’ç­]
```

**æ’ç­è¡¨ç½‘æ ¼è§†å›¾**ï¼š

**æ•°æ®ç»“æ„**ï¼š
- è¡Œå¤´ï¼šå“¨ä½åˆ—è¡¨ï¼ˆçºµå‘ï¼‰
- åˆ—å¤´ï¼šæ—¥æœŸ + æ—¶æ®µï¼ˆæ¨ªå‘ï¼‰
- å•å…ƒæ ¼ï¼šäººå‘˜å§“å + æ—¶æ®µä¿¡æ¯

**è§†è§‰è®¾è®¡**ï¼š

| å…ƒç´  | æ ·å¼ | ç”¨é€” |
|------|------|------|
| è¡¨å¤´ | å›ºå®šå®šä½ï¼Œç°è‰²èƒŒæ™¯ | æ—¥æœŸæ—¶æ®µæ ‡è¯† |
| è¡Œå¤´ | å›ºå®šå®šä½ï¼Œæµ…è‰²èƒŒæ™¯ | å“¨ä½æ ‡è¯† |
| å•å…ƒæ ¼ | ç™½è‰²å¡ç‰‡ï¼Œåœ†è§’è¾¹æ¡† | æ’ç­ä¿¡æ¯ |
| ç©ºå•å…ƒæ ¼ | è™šçº¿è¾¹æ¡† | æœªåˆ†é…æç¤º |
| å†²çªå•å…ƒæ ¼ | çº¢è‰²è¾¹æ¡†ï¼Œè­¦å‘Šå›¾æ ‡ | çº¦æŸå†²çª |
| Hover å•å…ƒæ ¼ | é˜´å½±åŠ æ·± | äº¤äº’åé¦ˆ |

**å•å…ƒæ ¼å†…å®¹**ï¼š
- ç¬¬ä¸€è¡Œï¼šäººå‘˜å§“åï¼ˆç²—ä½“ï¼‰
- ç¬¬äºŒè¡Œï¼šæ—¶æ®µï¼ˆå¦‚ 08:00-16:00ï¼‰
- å³ä¸Šè§’ï¼šçŠ¶æ€å›¾æ ‡ï¼ˆæ­£å¸¸/å†²çªï¼‰

**äº¤äº’è¡Œä¸º**ï¼š

| æ“ä½œ | è§¦å‘æ–¹å¼ | æ•ˆæœ |
|------|---------|------|
| æŸ¥çœ‹è¯¦æƒ… | å•å‡»å•å…ƒæ ¼ | å¼¹å‡ºè¯¦æƒ…å¯¹è¯æ¡† |
| æ‹–æ‹½è°ƒæ•´ | æŒ‰ä½æ‹–åŠ¨å•å…ƒæ ¼ | äº¤æ¢ä¸¤ä¸ªç­æ¬¡ |
| å³é”®èœå• | å³é”®å•å…ƒæ ¼ | æ˜¾ç¤ºæ“ä½œèœå• |
| æ‰¹é‡é€‰æ‹© | Ctrl+ç‚¹å‡» | å¤šé€‰å•å…ƒæ ¼ |

**å†²çªæç¤ºé¢æ¿**ï¼š
- ä½ç½®ï¼šé¡µé¢å³ä¾§å›ºå®šé¢æ¿ï¼ˆå¯æŠ˜å ï¼‰
- å†…å®¹ï¼š
  - å†²çªç±»å‹æ ‡ç­¾ï¼ˆç¡¬çº¦æŸ/è½¯çº¦æŸï¼‰
  - å†²çªæè¿°æ–‡æœ¬
  - æ¶‰åŠçš„äººå‘˜/å“¨ä½/æ—¶é—´
  - å»ºè®®æ“ä½œæŒ‰é’®

**è§†å›¾åˆ‡æ¢é€‰é¡¹**ï¼š
- ç½‘æ ¼è§†å›¾ï¼ˆé»˜è®¤ï¼‰
- æ—¥å†è§†å›¾ï¼ˆæŒ‰æ—¥æœŸå±•å¼€ï¼‰
- äººå‘˜è§†å›¾ï¼ˆæŒ‰äººå‘˜åˆ†ç»„ï¼‰
- åˆ—è¡¨è§†å›¾ï¼ˆçº¯è¡¨æ ¼ï¼‰

**åº•éƒ¨æ“ä½œæ **ï¼š

| æŒ‰é’® | å›¾æ ‡ | åŠŸèƒ½ | API è°ƒç”¨ |
|------|------|------|---------|
| ä¿å­˜è‰ç¨¿ | ğŸ’¾ | ä¿å­˜åˆ°è‰ç¨¿ç®± | POST /api/scheduling/buffer |
| ç¡®è®¤æ’ç­ | âœ… | ç¡®è®¤å¹¶ç§»å…¥å†å² | POST /api/scheduling/confirm/{id} |
| é‡æ–°æ’ç­ | ğŸ”„ | è¿”å›å‚æ•°é…ç½® | å¯¼èˆªåˆ°åˆ›å»ºé¡µé¢ |
| å¯¼å‡º | ğŸ“„ | å¯¼å‡ºä¸º Excel/PDF | GET /api/scheduling/export/{id} |

#### 3.2.3 è‰ç¨¿ç®±é¡µé¢

**é¡µé¢è·¯å¾„**ï¼š`/scheduling/drafts`

**åˆ—è¡¨è§†å›¾**ï¼š

| åˆ— | å®½åº¦ | å†…å®¹ | å¯æ’åº |
|-----|------|------|--------|
| æ’ç­è¡¨åç§° | 300px | æ ‡é¢˜ | æ˜¯ |
| åˆ›å»ºæ—¶é—´ | 180px | æ—¶é—´æˆ³ | æ˜¯ |
| æ—¥æœŸèŒƒå›´ | 200px | å¼€å§‹-ç»“æŸ | æ˜¯ |
| äººå‘˜æ•° | 80px | æ•°é‡ | æ˜¯ |
| å“¨ä½æ•° | 80px | æ•°é‡ | æ˜¯ |
| æ“ä½œ | 150px | æŸ¥çœ‹/ç¡®è®¤/åˆ é™¤ | å¦ |

**æ“ä½œæŒ‰é’®**ï¼š
- æŸ¥çœ‹ï¼šå¯¼èˆªåˆ°ç»“æœé¡µé¢ï¼ˆåªè¯»æ¨¡å¼ï¼‰
- ç¡®è®¤ï¼šå¼¹å‡ºç¡®è®¤å¯¹è¯æ¡†ï¼Œè°ƒç”¨ç¡®è®¤ API
- åˆ é™¤ï¼šå¼¹å‡ºç¡®è®¤å¯¹è¯æ¡†ï¼Œåˆ é™¤è‰ç¨¿

### 3.3 å†å²è®°å½•æ¨¡å—

#### 3.3.1 å†å²åˆ—è¡¨é¡µé¢

**é¡µé¢è·¯å¾„**ï¼š`/history`

**å¸ƒå±€ç»“æ„**ï¼š
- é¡¶éƒ¨ï¼šæœç´¢æ  + æ—¥æœŸèŒƒå›´ç­›é€‰å™¨
- ä¸»å†…å®¹ï¼šæ—¶é—´çº¿è§†å›¾ / åˆ—è¡¨è§†å›¾ï¼ˆå¯åˆ‡æ¢ï¼‰

**æ—¶é—´çº¿è§†å›¾è®¾è®¡**ï¼š

```mermaid
graph TB
    A[2024å¹´] --> B[2024å¹´12æœˆ]
    B --> C1[2024-12-01 æ’ç­è¡¨]
    B --> C2[2024-12-15 æ’ç­è¡¨]
    A --> D[2024å¹´11æœˆ]
    D --> E1[2024-11-01 æ’ç­è¡¨]
    
    C1 --> F1[æŸ¥çœ‹è¯¦æƒ…]
    C1 --> F2[å¯¼å‡º]
    C1 --> F3[å¯¹æ¯”]
```

**æ—¶é—´çº¿å¡ç‰‡å†…å®¹**ï¼š
- å·¦ä¾§ï¼šæ—¥æœŸå›¾æ ‡ + æ—¥æœŸæ–‡æœ¬
- ä¸­é—´ï¼šæ’ç­è¡¨åç§°ã€äººå‘˜æ•°ã€å“¨ä½æ•°ã€ç¡®è®¤æ—¶é—´
- å³ä¾§ï¼šæ“ä½œæŒ‰é’®ç»„

**åˆ—è¡¨è§†å›¾**ï¼š
- ä½¿ç”¨ DataGrid æ§ä»¶
- æ”¯æŒæ’åºã€ç­›é€‰ã€åˆ†é¡µ
- åˆ—è®¾è®¡ï¼šç¡®è®¤æ—¥æœŸã€æ’ç­è¡¨åç§°ã€æ—¥æœŸèŒƒå›´ã€äººå‘˜/å“¨ä½æ•°é‡ã€æ“ä½œ

**ç­›é€‰å™¨é€‰é¡¹**ï¼š

| ç­›é€‰é¡¹ | æ§ä»¶ç±»å‹ | è¯´æ˜ |
|--------|---------|------|
| æ—¥æœŸèŒƒå›´ | DateRangePicker | ç¡®è®¤æ—¶é—´èŒƒå›´ |
| å…³é”®è¯ | SearchBox | æœç´¢åç§° |
| æ’åºæ–¹å¼ | ComboBox | æ—¶é—´/åç§° |

#### 3.3.2 å†å²è¯¦æƒ…é¡µé¢

**é¡µé¢è·¯å¾„**ï¼š`/history/detail/{scheduleId}`

**å¸ƒå±€è®¾è®¡**ï¼š
- é¡¶éƒ¨ï¼šæ’ç­è¡¨åŸºæœ¬ä¿¡æ¯å¡ç‰‡
- ä¸»å†…å®¹ï¼šæ’ç­è¡¨ç½‘æ ¼ï¼ˆåªè¯»æ¨¡å¼ï¼‰
- å³ä¾§ï¼šç»Ÿè®¡ä¿¡æ¯é¢æ¿

**åŸºæœ¬ä¿¡æ¯å¡ç‰‡**ï¼š

| å­—æ®µ | æ˜¾ç¤ºæ–¹å¼ |
|------|---------|
| æ’ç­è¡¨åç§° | å¤§æ ‡é¢˜ |
| æ—¥æœŸèŒƒå›´ | å‰¯æ ‡é¢˜ |
| ç¡®è®¤æ—¶é—´ | æ—¶é—´æˆ³ |
| å‚ä¸äººå‘˜ | äººå‘˜æ ‡ç­¾ç»„ |
| å‚ä¸å“¨ä½ | å“¨ä½æ ‡ç­¾ç»„ |

**ç»Ÿè®¡ä¿¡æ¯é¢æ¿**ï¼š

**ç»Ÿè®¡æŒ‡æ ‡**ï¼š

| æŒ‡æ ‡åç§° | è®¡ç®—æ–¹å¼ | å±•ç¤ºæ§ä»¶ |
|---------|---------|---------|
| æ€»ç­æ¬¡æ•° | æ‰€æœ‰å•æ¬¡æ’ç­æ•°é‡ | æ•°å­—å¡ç‰‡ |
| äººå‡ç­æ¬¡ | æ€»ç­æ¬¡ / äººå‘˜æ•° | æ•°å­—å¡ç‰‡ |
| ä¼‘æ¯æ—¥ç­æ¬¡ | èŠ‚å‡æ—¥çš„ç­æ¬¡æ•° | æ•°å­—å¡ç‰‡ |
| å„æ—¶æ®µåˆ†å¸ƒ | 12ä¸ªæ—¶æ®µçš„ç­æ¬¡æ•° | æŸ±çŠ¶å›¾ |
| äººå‘˜è´Ÿè½½ | æ¯äººçš„ç­æ¬¡æ•° | æ¨ªå‘æ¡å½¢å›¾ |
| å“¨ä½è¦†ç›–ç‡ | å·²åˆ†é…/æ€»éœ€æ±‚ | ç™¾åˆ†æ¯”è¿›åº¦æ¡ |

**å›¾è¡¨è®¾è®¡**ï¼ˆä½¿ç”¨ WinUI Community Toolkit Chart æ§ä»¶ï¼‰ï¼š
- æ—¶æ®µåˆ†å¸ƒï¼š12 åˆ—æŸ±çŠ¶å›¾ï¼ŒX è½´ä¸ºæ—¶æ®µï¼ŒY è½´ä¸ºç­æ¬¡æ•°
- äººå‘˜è´Ÿè½½ï¼šæ°´å¹³æ¡å½¢å›¾ï¼ŒX è½´ä¸ºç­æ¬¡æ•°ï¼ŒY è½´ä¸ºäººå‘˜å§“å

#### 3.3.3 å¯¹æ¯”é¡µé¢

**é¡µé¢è·¯å¾„**ï¼š`/history/compare`

**å¸ƒå±€ç»“æ„**ï¼š
- é¡¶éƒ¨ï¼šé€‰æ‹©ä¸¤ä¸ªæ’ç­è¡¨ï¼ˆComboBoxï¼‰
- ä¸»å†…å®¹ï¼šå·¦å³åˆ†æ å¯¹æ¯”è§†å›¾
- åº•éƒ¨ï¼šå·®å¼‚ç»Ÿè®¡æ±‡æ€»

**å¯¹æ¯”è§†å›¾æ¨¡å¼**ï¼š

| æ¨¡å¼ | è¯´æ˜ | è§†è§‰æ•ˆæœ |
|------|------|---------|
| å¹¶æ’å¯¹æ¯” | å·¦å³ä¸¤ä¸ªç½‘æ ¼è§†å›¾ | åŒæ­¥æ»šåŠ¨ |
| å·®å¼‚é«˜äº® | åˆå¹¶è§†å›¾ï¼Œå·®å¼‚å•å…ƒæ ¼é«˜äº® | çº¢è‰²/ç»¿è‰²æ ‡è®° |
| ç»Ÿè®¡å¯¹æ¯” | æ•°æ®æŒ‡æ ‡å¯¹æ¯”è¡¨ | ç®­å¤´æŒ‡ç¤ºå¢å‡ |

**å·®å¼‚ç±»å‹**ï¼š

| å·®å¼‚ç±»å‹ | é¢œè‰²æ ‡è®° | è¯´æ˜ |
|---------|---------|------|
| æ–°å¢ç­æ¬¡ | ç»¿è‰²èƒŒæ™¯ | å³ä¾§æœ‰ï¼Œå·¦ä¾§æ—  |
| åˆ é™¤ç­æ¬¡ | çº¢è‰²èƒŒæ™¯ | å·¦ä¾§æœ‰ï¼Œå³ä¾§æ—  |
| äººå‘˜å˜æ›´ | é»„è‰²èƒŒæ™¯ | åŒä½ç½®ä¸åŒäººå‘˜ |
| æ—¶é—´è°ƒæ•´ | è“è‰²èƒŒæ™¯ | æ—¶æ®µå˜åŒ– |

## å››ã€å‰åç«¯æ¥å£è®¾è®¡

### 4.1 API ç«¯ç‚¹è§„èŒƒ

**RESTful è®¾è®¡åŸåˆ™**ï¼š
- ä½¿ç”¨åè¯å¤æ•°å½¢å¼è¡¨ç¤ºèµ„æº
- ä½¿ç”¨ HTTP æ–¹æ³•è¡¨ç¤ºæ“ä½œï¼ˆGET/POST/PUT/DELETEï¼‰
- ä½¿ç”¨è·¯å¾„å‚æ•°ä¼ é€’ ID
- ä½¿ç”¨æŸ¥è¯¢å‚æ•°ä¼ é€’ç­›é€‰æ¡ä»¶
- ç»Ÿä¸€è¿”å› JSON æ ¼å¼

**API åŸºç¡€è·¯å¾„**ï¼š`https://localhost:5001/api/v1`

### 4.2 äººå‘˜æœåŠ¡ API

| æ–¹æ³• | ç«¯ç‚¹ | è¯´æ˜ | è¯·æ±‚ä½“ | å“åº”ä½“ |
|------|------|------|--------|--------|
| GET | /personnel | è·å–æ‰€æœ‰äººå‘˜ | æ—  | PersonnelDto[] |
| GET | /personnel/{id} | è·å–æŒ‡å®šäººå‘˜ | æ—  | PersonnelDto |
| POST | /personnel | åˆ›å»ºäººå‘˜ | CreatePersonnelDto | PersonnelDto |
| PUT | /personnel/{id} | æ›´æ–°äººå‘˜ | UpdatePersonnelDto | PersonnelDto |
| DELETE | /personnel/{id} | åˆ é™¤äººå‘˜ | æ—  | 204 No Content |
| GET | /personnel/search | æœç´¢äººå‘˜ | Query: keyword | PersonnelDto[] |

**PersonnelDto æ•°æ®ç»“æ„**ï¼š

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | int | äººå‘˜ ID |
| name | string | å§“å |
| positionId | int | èŒä½ ID |
| positionName | string | èŒä½åç§°ï¼ˆå†—ä½™å­—æ®µï¼‰ |
| skillIds | int[] | æŠ€èƒ½ ID åˆ—è¡¨ |
| skillNames | string[] | æŠ€èƒ½åç§°åˆ—è¡¨ï¼ˆå†—ä½™ï¼‰ |
| isAvailable | boolean | æ˜¯å¦å¯ç”¨ |
| isRetired | boolean | æ˜¯å¦é€€å½¹ |
| recentShiftIntervalCount | int | æœ€è¿‘ç­æ¬¡é—´éš” |
| recentHolidayShiftIntervalCount | int | èŠ‚å‡æ—¥ç­æ¬¡é—´éš” |
| recentPeriodShiftIntervals | int[12] | æ—¶æ®µç­æ¬¡é—´éš” |

**CreatePersonnelDto**ï¼š

| å­—æ®µ | ç±»å‹ | å¿…å¡« | éªŒè¯è§„åˆ™ |
|------|------|------|---------|
| name | string | æ˜¯ | 1-50å­—ç¬¦ |
| positionId | int | æ˜¯ | å­˜åœ¨çš„èŒä½ ID |
| skillIds | int[] | æ˜¯ | è‡³å°‘ä¸€é¡¹ï¼Œå­˜åœ¨çš„æŠ€èƒ½ ID |
| isAvailable | boolean | å¦ | é»˜è®¤ true |
| recentShiftIntervalCount | int | å¦ | 0-999 |
| recentHolidayShiftIntervalCount | int | å¦ | 0-999 |
| recentPeriodShiftIntervals | int[12] | å¦ | æ¯é¡¹ 0-999 |

### 4.3 å“¨ä½æœåŠ¡ API

| æ–¹æ³• | ç«¯ç‚¹ | è¯´æ˜ | è¯·æ±‚ä½“ | å“åº”ä½“ |
|------|------|------|--------|--------|
| GET | /positions | è·å–æ‰€æœ‰å“¨ä½ | æ—  | PositionDto[] |
| GET | /positions/{id} | è·å–æŒ‡å®šå“¨ä½ | æ—  | PositionDto |
| POST | /positions | åˆ›å»ºå“¨ä½ | CreatePositionDto | PositionDto |
| PUT | /positions/{id} | æ›´æ–°å“¨ä½ | UpdatePositionDto | PositionDto |
| DELETE | /positions/{id} | åˆ é™¤å“¨ä½ | æ—  | 204 No Content |

**PositionDto æ•°æ®ç»“æ„**ï¼š

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | int | å“¨ä½ ID |
| name | string | å“¨ä½åç§° |
| location | string | åœ°ç‚¹ |
| description | string | ä»‹ç» |
| requirements | string | è¦æ±‚è¯´æ˜ |
| requiredSkillIds | int[] | æ‰€éœ€æŠ€èƒ½ ID |
| requiredSkillNames | string[] | æ‰€éœ€æŠ€èƒ½åç§°ï¼ˆå†—ä½™ï¼‰ |

### 4.4 æŠ€èƒ½æœåŠ¡ API

| æ–¹æ³• | ç«¯ç‚¹ | è¯´æ˜ | è¯·æ±‚ä½“ | å“åº”ä½“ |
|------|------|------|--------|--------|
| GET | /skills | è·å–æ‰€æœ‰æŠ€èƒ½ | æ—  | SkillDto[] |
| GET | /skills/{id} | è·å–æŒ‡å®šæŠ€èƒ½ | æ—  | SkillDto |
| POST | /skills | åˆ›å»ºæŠ€èƒ½ | CreateSkillDto | SkillDto |
| PUT | /skills/{id} | æ›´æ–°æŠ€èƒ½ | UpdateSkillDto | SkillDto |
| DELETE | /skills/{id} | åˆ é™¤æŠ€èƒ½ | æ—  | 204 No Content |

**SkillDto æ•°æ®ç»“æ„**ï¼š

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | int | æŠ€èƒ½ ID |
| name | string | æŠ€èƒ½åç§° |
| description | string | æŠ€èƒ½æè¿° |

### 4.5 çº¦æŸæœåŠ¡ API

**ä¼‘æ¯æ—¥é…ç½®**ï¼š

| æ–¹æ³• | ç«¯ç‚¹ | è¯´æ˜ | è¯·æ±‚ä½“ | å“åº”ä½“ |
|------|------|------|--------|--------|
| GET | /constraints/holidays | è·å–æ‰€æœ‰é…ç½® | æ—  | HolidayConfigDto[] |
| GET | /constraints/holidays/active | è·å–æ´»åŠ¨é…ç½® | æ—  | HolidayConfigDto |
| POST | /constraints/holidays | åˆ›å»ºé…ç½® | CreateHolidayConfigDto | HolidayConfigDto |
| PUT | /constraints/holidays/{id} | æ›´æ–°é…ç½® | UpdateHolidayConfigDto | HolidayConfigDto |
| DELETE | /constraints/holidays/{id} | åˆ é™¤é…ç½® | æ—  | 204 No Content |

**HolidayConfigDto æ•°æ®ç»“æ„**ï¼š

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | int | é…ç½® ID |
| configName | string | é…ç½®åç§° |
| enableWeekendRule | boolean | æ˜¯å¦å¯ç”¨å‘¨æœ«è§„åˆ™ |
| weekendDays | string[] | å‘¨æœ«æ—¥æœŸï¼ˆå¦‚ ["Saturday", "Sunday"]ï¼‰ |
| legalHolidays | string[] | æ³•å®šå‡æ—¥ï¼ˆISO 8601 æ—¥æœŸï¼‰ |
| customHolidays | string[] | è‡ªå®šä¹‰å‡æ—¥ |
| excludedDates | string[] | æ’é™¤æ—¥æœŸ |
| isActive | boolean | æ˜¯å¦å¯ç”¨ |

**å®šå²—è§„åˆ™**ï¼š

| æ–¹æ³• | ç«¯ç‚¹ | è¯´æ˜ |
|------|------|------|
| GET | /constraints/fixed-positions | è·å–æ‰€æœ‰è§„åˆ™ |
| POST | /constraints/fixed-positions | åˆ›å»ºè§„åˆ™ |
| PUT | /constraints/fixed-positions/{id} | æ›´æ–°è§„åˆ™ |
| DELETE | /constraints/fixed-positions/{id} | åˆ é™¤è§„åˆ™ |

**æ‰‹åŠ¨æŒ‡å®š**ï¼š

| æ–¹æ³• | ç«¯ç‚¹ | è¯´æ˜ |
|------|------|------|
| GET | /constraints/manual-assignments | è·å–æ‰€æœ‰æŒ‡å®š |
| GET | /constraints/manual-assignments?start=&end= | æŒ‰æ—¥æœŸèŒƒå›´è·å– |
| POST | /constraints/manual-assignments | åˆ›å»ºæŒ‡å®š |
| PUT | /constraints/manual-assignments/{id} | æ›´æ–°æŒ‡å®š |
| DELETE | /constraints/manual-assignments/{id} | åˆ é™¤æŒ‡å®š |

### 4.6 æ’ç­æœåŠ¡ API

| æ–¹æ³• | ç«¯ç‚¹ | è¯´æ˜ | è¯·æ±‚ä½“ | å“åº”ä½“ |
|------|------|------|--------|--------|
| POST | /scheduling/execute | æ‰§è¡Œæ’ç­ | SchedulingRequestDto | ScheduleDto |
| GET | /scheduling/drafts | è·å–è‰ç¨¿åˆ—è¡¨ | æ—  | ScheduleSummaryDto[] |
| GET | /scheduling/drafts/{id} | è·å–è‰ç¨¿è¯¦æƒ… | æ—  | ScheduleDto |
| DELETE | /scheduling/drafts/{id} | åˆ é™¤è‰ç¨¿ | æ—  | 204 No Content |
| POST | /scheduling/confirm/{id} | ç¡®è®¤æ’ç­ | æ—  | 204 No Content |
| GET | /scheduling/export/{id} | å¯¼å‡ºæ’ç­è¡¨ | Query: format=excel\|pdf | æ–‡ä»¶æµ |

**SchedulingRequestDto æ•°æ®ç»“æ„**ï¼š

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| title | string | æ˜¯ | æ’ç­è¡¨åç§° |
| startDate | string | æ˜¯ | å¼€å§‹æ—¥æœŸï¼ˆISO 8601ï¼‰ |
| endDate | string | æ˜¯ | ç»“æŸæ—¥æœŸ |
| personnelIds | int[] | æ˜¯ | å‚ä¸äººå‘˜ ID åˆ—è¡¨ |
| positionIds | int[] | æ˜¯ | å‚ä¸å“¨ä½ ID åˆ—è¡¨ |
| useActiveHolidayConfig | boolean | å¦ | æ˜¯å¦ä½¿ç”¨æ´»åŠ¨å‡æ—¥é…ç½®ï¼ˆé»˜è®¤ trueï¼‰ |
| enabledFixedRuleIds | int[] | å¦ | å¯ç”¨çš„å®šå²—è§„åˆ™ ID |
| enabledManualAssignmentIds | int[] | å¦ | å¯ç”¨çš„æ‰‹åŠ¨æŒ‡å®š ID |

**ScheduleDto æ•°æ®ç»“æ„**ï¼š

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | int | æ’ç­è¡¨ ID |
| title | string | æ’ç­è¡¨åç§° |
| personnelIds | int[] | äººå‘˜ ID åˆ—è¡¨ |
| positionIds | int[] | å“¨ä½ ID åˆ—è¡¨ |
| shifts | ShiftDto[] | å•æ¬¡æ’ç­åˆ—è¡¨ |
| createdAt | string | åˆ›å»ºæ—¶é—´ |
| confirmedAt | string | ç¡®è®¤æ—¶é—´ï¼ˆè‰ç¨¿ä¸º nullï¼‰ |

**ShiftDto æ•°æ®ç»“æ„**ï¼š

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | int | ç­æ¬¡ ID |
| scheduleId | int | æ‰€å±æ’ç­è¡¨ ID |
| positionId | int | å“¨ä½ ID |
| positionName | string | å“¨ä½åç§°ï¼ˆå†—ä½™ï¼‰ |
| personnelId | int | äººå‘˜ ID |
| personnelName | string | äººå‘˜å§“åï¼ˆå†—ä½™ï¼‰ |
| startTime | string | å¼€å§‹æ—¶é—´ï¼ˆISO 8601ï¼‰ |
| endTime | string | ç»“æŸæ—¶é—´ |
| periodIndex | int | æ—¶æ®µç´¢å¼•ï¼ˆ0-11ï¼‰ |

### 4.7 å†å²æœåŠ¡ API

| æ–¹æ³• | ç«¯ç‚¹ | è¯´æ˜ | è¯·æ±‚ä½“ | å“åº”ä½“ |
|------|------|------|--------|--------|
| GET | /history | è·å–å†å²åˆ—è¡¨ | Query: page, size, startDate, endDate | PagedScheduleSummaryDto |
| GET | /history/{id} | è·å–å†å²è¯¦æƒ… | æ—  | ScheduleDto |
| GET | /history/compare | å¯¹æ¯”ä¸¤ä¸ªæ’ç­è¡¨ | Query: id1, id2 | CompareResultDto |

**PagedScheduleSummaryDto æ•°æ®ç»“æ„**ï¼š

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| items | ScheduleSummaryDto[] | æ’ç­è¡¨æ‘˜è¦åˆ—è¡¨ |
| totalCount | int | æ€»æ•° |
| page | int | å½“å‰é¡µç  |
| pageSize | int | æ¯é¡µå¤§å° |
| totalPages | int | æ€»é¡µæ•° |

**ScheduleSummaryDto æ•°æ®ç»“æ„**ï¼š

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | int | æ’ç­è¡¨ ID |
| title | string | æ’ç­è¡¨åç§° |
| startDate | string | å¼€å§‹æ—¥æœŸ |
| endDate | string | ç»“æŸæ—¥æœŸ |
| personnelCount | int | äººå‘˜æ•°é‡ |
| positionCount | int | å“¨ä½æ•°é‡ |
| shiftCount | int | ç­æ¬¡æ•°é‡ |
| confirmedAt | string | ç¡®è®¤æ—¶é—´ |

**CompareResultDto æ•°æ®ç»“æ„**ï¼š

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| schedule1 | ScheduleDto | ç¬¬ä¸€ä¸ªæ’ç­è¡¨ |
| schedule2 | ScheduleDto | ç¬¬äºŒä¸ªæ’ç­è¡¨ |
| differences | DifferenceDto[] | å·®å¼‚åˆ—è¡¨ |
| statistics | CompareStatisticsDto | ç»Ÿè®¡ä¿¡æ¯ |

**DifferenceDto æ•°æ®ç»“æ„**ï¼š

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| type | string | å·®å¼‚ç±»å‹ï¼ˆAdded/Removed/Modifiedï¼‰ |
| positionId | int | å“¨ä½ ID |
| date | string | æ—¥æœŸ |
| periodIndex | int | æ—¶æ®µç´¢å¼• |
| oldPersonnelId | int | åŸäººå‘˜ IDï¼ˆå¯ç©ºï¼‰ |
| newPersonnelId | int | æ–°äººå‘˜ IDï¼ˆå¯ç©ºï¼‰ |

### 4.8 API é€šç”¨å“åº”æ ¼å¼

**æˆåŠŸå“åº”**ï¼š

```json
{
  "success": true,
  "data": { /* å®é™…æ•°æ® */ },
  "message": "æ“ä½œæˆåŠŸ",
  "timestamp": "2024-01-01T12:00:00Z"
}
```

**é”™è¯¯å“åº”**ï¼š

```json
{
  "success": false,
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "æ•°æ®éªŒè¯å¤±è´¥",
    "details": [
      {
        "field": "name",
        "message": "å§“åä¸èƒ½ä¸ºç©º"
      }
    ]
  },
  "timestamp": "2024-01-01T12:00:00Z"
}
```

**HTTP çŠ¶æ€ç è§„èŒƒ**ï¼š

| çŠ¶æ€ç  | åœºæ™¯ | è¯´æ˜ |
|--------|------|------|
| 200 | æˆåŠŸ | GET/PUT æˆåŠŸ |
| 201 | åˆ›å»ºæˆåŠŸ | POST æˆåŠŸ |
| 204 | æ— å†…å®¹ | DELETE æˆåŠŸ |
| 400 | è¯·æ±‚é”™è¯¯ | å‚æ•°éªŒè¯å¤±è´¥ |
| 401 | æœªæˆæƒ | æœªç™»å½•æˆ– Token å¤±æ•ˆ |
| 403 | ç¦æ­¢è®¿é—® | æ— æƒé™ |
| 404 | æœªæ‰¾åˆ° | èµ„æºä¸å­˜åœ¨ |
| 409 | å†²çª | æ•°æ®å†²çªï¼ˆå¦‚é‡å¤åˆ›å»ºï¼‰ |
| 500 | æœåŠ¡å™¨é”™è¯¯ | å†…éƒ¨é”™è¯¯ |

## äº”ã€ViewModel è®¾è®¡

### 5.1 MVVM æ¶æ„æ¨¡å¼

**æ¶æ„åˆ†å±‚**ï¼š

```mermaid
graph TB
    subgraph "View å±‚"
        V1[PersonnelPage.xaml]
        V2[PositionPage.xaml]
        V3[SchedulingPage.xaml]
    end
    
    subgraph "ViewModel å±‚"
        VM1[PersonnelViewModel]
        VM2[PositionViewModel]
        VM3[SchedulingViewModel]
    end
    
    subgraph "Service å±‚"
        S1[PersonnelApiService]
        S2[PositionApiService]
        S3[SchedulingApiService]
    end
    
    subgraph "Model å±‚"
        M1[PersonnelDto]
        M2[PositionDto]
        M3[ScheduleDto]
    end
    
    V1 <--> VM1
    V2 <--> VM2
    V3 <--> VM3
    
    VM1 --> S1
    VM2 --> S2
    VM3 --> S3
    
    S1 --> M1
    S2 --> M2
    S3 --> M3
```

### 5.2 æ ¸å¿ƒ ViewModel è®¾è®¡

#### 5.2.1 PersonnelViewModel

**èŒè´£**ï¼š
- ç®¡ç†äººå‘˜åˆ—è¡¨çš„åŠ è½½ã€ç­›é€‰ã€æœç´¢
- å¤„ç†äººå‘˜çš„å¢åˆ æ”¹æ“ä½œ
- éªŒè¯è¡¨å•è¾“å…¥
- ç®¡ç†é€‰ä¸­çŠ¶æ€

**å±æ€§å®šä¹‰**ï¼š

| å±æ€§åç§° | ç±»å‹ | è¯´æ˜ | é€šçŸ¥å˜æ›´ |
|---------|------|------|---------|
| Personnels | ObservableCollection\<PersonnelDto\> | äººå‘˜åˆ—è¡¨ | æ˜¯ |
| FilteredPersonnels | ObservableCollection\<PersonnelDto\> | ç­›é€‰ååˆ—è¡¨ | æ˜¯ |
| SelectedPersonnel | PersonnelDto | é€‰ä¸­äººå‘˜ | æ˜¯ |
| IsLoading | bool | åŠ è½½çŠ¶æ€ | æ˜¯ |
| SearchKeyword | string | æœç´¢å…³é”®è¯ | æ˜¯ |
| FilterStatus | PersonnelStatus | ç­›é€‰çŠ¶æ€ | æ˜¯ |
| AllSkills | ObservableCollection\<SkillDto\> | æ‰€æœ‰æŠ€èƒ½ | æ˜¯ |
| AllPositions | ObservableCollection\<PositionDto\> | æ‰€æœ‰èŒä½ | æ˜¯ |

**å‘½ä»¤å®šä¹‰**ï¼š

| å‘½ä»¤åç§° | å‚æ•° | è¯´æ˜ | æ‰§è¡Œæ¡ä»¶ |
|---------|------|------|---------|
| LoadPersonnelsCommand | æ—  | åŠ è½½äººå‘˜åˆ—è¡¨ | æ€»æ˜¯å¯ç”¨ |
| CreatePersonnelCommand | æ—  | æ‰“å¼€åˆ›å»ºå¯¹è¯æ¡† | æ€»æ˜¯å¯ç”¨ |
| SavePersonnelCommand | PersonnelDto | ä¿å­˜äººå‘˜ï¼ˆåˆ›å»ºæˆ–æ›´æ–°ï¼‰ | è¡¨å•éªŒè¯é€šè¿‡ |
| DeletePersonnelCommand | int | åˆ é™¤äººå‘˜ | æœ‰é€‰ä¸­é¡¹ |
| SearchCommand | string | æœç´¢äººå‘˜ | æ€»æ˜¯å¯ç”¨ |
| ApplyFilterCommand | PersonnelStatus | åº”ç”¨ç­›é€‰ | æ€»æ˜¯å¯ç”¨ |

**å…³é”®æ–¹æ³•é€»è¾‘**ï¼š

**LoadPersonnelsAsync**ï¼š
1. è®¾ç½® IsLoading = true
2. è°ƒç”¨ PersonnelApiService.GetAllAsync()
3. æ¥æ”¶ PersonnelDto[] å¹¶è½¬æ¢ä¸º ObservableCollection
4. ç»‘å®šåˆ° Personnels å±æ€§
5. åº”ç”¨ç­›é€‰å’Œæœç´¢
6. è®¾ç½® IsLoading = false
7. é”™è¯¯å¤„ç†ï¼šæ•è·å¼‚å¸¸ï¼Œæ˜¾ç¤ºé”™è¯¯å¯¹è¯æ¡†

**SavePersonnelAsync**ï¼š
1. éªŒè¯è¡¨å•æ•°æ®ï¼ˆå§“åéç©ºã€æŠ€èƒ½è‡³å°‘ä¸€é¡¹ç­‰ï¼‰
2. åˆ¤æ–­æ˜¯åˆ›å»ºè¿˜æ˜¯æ›´æ–°ï¼ˆId == 0 ä¸ºåˆ›å»ºï¼‰
3. åˆ›å»ºï¼šè°ƒç”¨ CreateAsync(dto)
4. æ›´æ–°ï¼šè°ƒç”¨ UpdateAsync(id, dto)
5. æˆåŠŸååˆ·æ–°åˆ—è¡¨
6. æ˜¾ç¤ºæˆåŠŸæç¤ºï¼ˆInfoBarï¼‰
7. å…³é—­ç¼–è¾‘å¯¹è¯æ¡†

**ApplyFilter**ï¼š
1. æ ¹æ® FilterStatus ç­›é€‰ Personnels
2. åº”ç”¨ SearchKeyword æœç´¢å§“å
3. æ›´æ–° FilteredPersonnels

#### 5.2.2 SchedulingViewModel

**èŒè´£**ï¼š
- ç®¡ç†æ’ç­å‘å¯¼æµç¨‹
- æ”¶é›†æ’ç­å‚æ•°
- è°ƒç”¨æ’ç­ API
- å±•ç¤ºæ’ç­ç»“æœ

**å±æ€§å®šä¹‰**ï¼š

| å±æ€§åç§° | ç±»å‹ | è¯´æ˜ |
|---------|------|------|
| CurrentStep | int | å½“å‰æ­¥éª¤ï¼ˆ1-5ï¼‰ |
| ScheduleTitle | string | æ’ç­è¡¨åç§° |
| StartDate | DateTimeOffset | å¼€å§‹æ—¥æœŸ |
| EndDate | DateTimeOffset | ç»“æŸæ—¥æœŸ |
| AvailablePersonnels | ObservableCollection\<PersonnelDto\> | å¯é€‰äººå‘˜ |
| SelectedPersonnels | ObservableCollection\<PersonnelDto\> | å·²é€‰äººå‘˜ |
| AvailablePositions | ObservableCollection\<PositionDto\> | å¯é€‰å“¨ä½ |
| SelectedPositions | ObservableCollection\<PositionDto\> | å·²é€‰å“¨ä½ |
| HolidayConfigs | ObservableCollection\<HolidayConfigDto\> | å‡æ—¥é…ç½® |
| SelectedHolidayConfig | HolidayConfigDto | é€‰ä¸­é…ç½® |
| FixedRules | ObservableCollection\<FixedRuleDto\> | å®šå²—è§„åˆ™ |
| EnabledFixedRules | List\<int\> | å¯ç”¨è§„åˆ™ ID |
| ManualAssignments | ObservableCollection\<ManualAssignmentDto\> | æ‰‹åŠ¨æŒ‡å®š |
| EnabledManualAssignments | List\<int\> | å¯ç”¨æŒ‡å®š ID |
| IsExecuting | bool | æ˜¯å¦æ­£åœ¨æ‰§è¡Œ |
| ResultSchedule | ScheduleDto | æ’ç­ç»“æœ |

**å‘½ä»¤å®šä¹‰**ï¼š

| å‘½ä»¤åç§° | è¯´æ˜ | æ‰§è¡Œæ¡ä»¶ |
|---------|------|---------|
| NextStepCommand | ä¸‹ä¸€æ­¥ | å½“å‰æ­¥éª¤éªŒè¯é€šè¿‡ |
| PreviousStepCommand | ä¸Šä¸€æ­¥ | ä¸åœ¨ç¬¬ä¸€æ­¥ |
| ExecuteSchedulingCommand | æ‰§è¡Œæ’ç­ | åœ¨æœ€åä¸€æ­¥ä¸”å‚æ•°å®Œæ•´ |
| CancelCommand | å–æ¶ˆå‘å¯¼ | æ€»æ˜¯å¯ç”¨ |

**æ‰§è¡Œæ’ç­æµç¨‹**ï¼š

```mermaid
sequenceDiagram
    participant VM as SchedulingViewModel
    participant API as SchedulingApiService
    participant Server as åç«¯æœåŠ¡
    
    VM->>VM: éªŒè¯æ‰€æœ‰å‚æ•°
    VM->>VM: æ„å»º SchedulingRequestDto
    VM->>VM: IsExecuting = true
    VM->>API: ExecuteAsync(request)
    API->>Server: POST /api/scheduling/execute
    
    Note over Server: æ‰§è¡Œæ’ç­ç®—æ³•
    
    Server-->>API: ScheduleDto
    API-->>VM: ScheduleDto
    VM->>VM: ResultSchedule = result
    VM->>VM: IsExecuting = false
    VM->>VM: å¯¼èˆªåˆ°ç»“æœé¡µé¢
```

### 5.3 å…±äº«æœåŠ¡è®¾è®¡

#### 5.3.1 NavigationService

**èŒè´£**ï¼šé¡µé¢å¯¼èˆªç®¡ç†

**æ–¹æ³•å®šä¹‰**ï¼š

| æ–¹æ³• | å‚æ•° | è¯´æ˜ |
|------|------|------|
| NavigateTo | string pageKey | å¯¼èˆªåˆ°æŒ‡å®šé¡µé¢ |
| NavigateToWithParameter | string pageKey, object parameter | å¸¦å‚æ•°å¯¼èˆª |
| GoBack | æ—  | è¿”å›ä¸Šä¸€é¡µ |
| CanGoBack | æ—  | æ˜¯å¦å¯è¿”å› |

#### 5.3.2 DialogService

**èŒè´£**ï¼šå¯¹è¯æ¡†ç®¡ç†

**æ–¹æ³•å®šä¹‰**ï¼š

| æ–¹æ³• | å‚æ•° | è¿”å›å€¼ | è¯´æ˜ |
|------|------|--------|------|
| ShowMessageAsync | string title, string message | Task | æ˜¾ç¤ºæ¶ˆæ¯å¯¹è¯æ¡† |
| ShowConfirmAsync | string title, string message | Task\<bool\> | æ˜¾ç¤ºç¡®è®¤å¯¹è¯æ¡† |
| ShowErrorAsync | string message | Task | æ˜¾ç¤ºé”™è¯¯å¯¹è¯æ¡† |
| ShowProgressAsync | string message | Task\<IDisposable\> | æ˜¾ç¤ºè¿›åº¦å¯¹è¯æ¡† |

#### 5.3.3 ApiClientService

**èŒè´£**ï¼šHTTP è¯·æ±‚å°è£…

**æ–¹æ³•å®šä¹‰**ï¼š

| æ–¹æ³• | è¯´æ˜ |
|------|------|
| GetAsync\<T\>(string url) | GET è¯·æ±‚ |
| PostAsync\<T\>(string url, object data) | POST è¯·æ±‚ |
| PutAsync\<T\>(string url, object data) | PUT è¯·æ±‚ |
| DeleteAsync(string url) | DELETE è¯·æ±‚ |

**é€šç”¨é€»è¾‘**ï¼š
- è‡ªåŠ¨æ·»åŠ  Authorization Header
- è‡ªåŠ¨åºåˆ—åŒ–/ååºåˆ—åŒ– JSON
- ç»Ÿä¸€å¼‚å¸¸å¤„ç†
- è¯·æ±‚è¶…æ—¶æ§åˆ¶
- è¯·æ±‚æ—¥å¿—è®°å½•

## å…­ã€æ§ä»¶åº“ä¸ç»„ä»¶è®¾è®¡

### 6.1 è‡ªå®šä¹‰æ§ä»¶

#### 6.1.1 ScheduleGridControlï¼ˆæ’ç­ç½‘æ ¼æ§ä»¶ï¼‰

**ç”¨é€”**ï¼šæ˜¾ç¤ºæ’ç­è¡¨çš„ç½‘æ ¼è§†å›¾

**å±æ€§**ï¼š

| å±æ€§åç§° | ç±»å‹ | è¯´æ˜ |
|---------|------|------|
| Schedule | ScheduleDto | æ’ç­æ•°æ®æº |
| Positions | ObservableCollection\<PositionDto\> | å“¨ä½åˆ—è¡¨ |
| Personnels | ObservableCollection\<PersonnelDto\> | äººå‘˜åˆ—è¡¨ |
| DateRange | DateRange | æ˜¾ç¤ºçš„æ—¥æœŸèŒƒå›´ |
| IsReadOnly | bool | æ˜¯å¦åªè¯» |
| ShowConflicts | bool | æ˜¯å¦æ˜¾ç¤ºå†²çª |

**äº‹ä»¶**ï¼š

| äº‹ä»¶åç§° | å‚æ•° | è¯´æ˜ |
|---------|------|------|
| CellClicked | ShiftDto | å•å…ƒæ ¼ç‚¹å‡» |
| CellDoubleClicked | ShiftDto | å•å…ƒæ ¼åŒå‡» |
| ShiftDragged | DragEventArgs | ç­æ¬¡æ‹–æ‹½ |

**è§†è§‰ç»“æ„**ï¼š
- ä½¿ç”¨ Grid å¸ƒå±€
- å›ºå®šè¡Œå¤´å’Œåˆ—å¤´
- æ”¯æŒè™šæ‹ŸåŒ–æ»šåŠ¨
- å•å…ƒæ ¼ä½¿ç”¨è‡ªå®šä¹‰ DataTemplate

#### 6.1.2 PersonnelCardï¼ˆäººå‘˜å¡ç‰‡æ§ä»¶ï¼‰

**ç”¨é€”**ï¼šæ˜¾ç¤ºäººå‘˜ä¿¡æ¯å¡ç‰‡

**å±æ€§**ï¼š

| å±æ€§åç§° | ç±»å‹ | è¯´æ˜ |
|---------|------|------|
| Personnel | PersonnelDto | äººå‘˜æ•°æ® |
| ShowActions | bool | æ˜¯å¦æ˜¾ç¤ºæ“ä½œæŒ‰é’® |
| IsSelected | bool | æ˜¯å¦é€‰ä¸­ |

**è§†è§‰è®¾è®¡**ï¼š
- åœ†è§’å¡ç‰‡ï¼ˆCornerRadius="8"ï¼‰
- Acrylic èƒŒæ™¯
- Hover åŠ¨ç”»ï¼ˆè½»å¾®ä¸Šæµ®ï¼‰
- é€‰ä¸­çŠ¶æ€ï¼ˆè¾¹æ¡†é«˜äº®ï¼‰

#### 6.1.3 PositionCardï¼ˆå“¨ä½å¡ç‰‡æ§ä»¶ï¼‰

**ç”¨é€”**ï¼šæ˜¾ç¤ºå“¨ä½ä¿¡æ¯å¡ç‰‡

**å±æ€§**ï¼š

| å±æ€§åç§° | ç±»å‹ | è¯´æ˜ |
|---------|------|------|
| Position | PositionDto | å“¨ä½æ•°æ® |
| ShowSkills | bool | æ˜¯å¦æ˜¾ç¤ºæŠ€èƒ½æ ‡ç­¾ |
| IsSelected | bool | æ˜¯å¦é€‰ä¸­ |

### 6.2 é€šç”¨ç»„ä»¶

#### 6.2.1 LoadingIndicatorï¼ˆåŠ è½½æŒ‡ç¤ºå™¨ï¼‰

**ç”¨é€”**ï¼šæ˜¾ç¤ºåŠ è½½çŠ¶æ€

**å±æ€§**ï¼š

| å±æ€§åç§° | ç±»å‹ | è¯´æ˜ |
|---------|------|------|
| IsLoading | bool | æ˜¯å¦åŠ è½½ä¸­ |
| Message | string | åŠ è½½æç¤ºæ–‡æœ¬ |
| Size | double | æŒ‡ç¤ºå™¨å¤§å° |

**è§†è§‰è®¾è®¡**ï¼š
- ä½¿ç”¨ ProgressRing
- åŠé€æ˜é®ç½©å±‚
- å±…ä¸­æ˜¾ç¤º
- æ·¡å…¥/æ·¡å‡ºåŠ¨ç”»

#### 6.2.2 EmptyStateï¼ˆç©ºçŠ¶æ€ç»„ä»¶ï¼‰

**ç”¨é€”**ï¼šæ˜¾ç¤ºç©ºæ•°æ®æç¤º

**å±æ€§**ï¼š

| å±æ€§åç§° | ç±»å‹ | è¯´æ˜ |
|---------|------|------|
| Icon | IconSource | å›¾æ ‡ |
| Title | string | æ ‡é¢˜ |
| Message | string | è¯´æ˜æ–‡æœ¬ |
| ActionText | string | æ“ä½œæŒ‰é’®æ–‡æœ¬ |
| ActionCommand | ICommand | æ“ä½œå‘½ä»¤ |

**è§†è§‰è®¾è®¡**ï¼š
- å±…ä¸­å¸ƒå±€
- å¤§å›¾æ ‡ï¼ˆ48x48ï¼‰
- æ¬¡è¦æ–‡æœ¬é¢œè‰²
- å¯é€‰æ“ä½œæŒ‰é’®

#### 6.2.3 ErrorStateï¼ˆé”™è¯¯çŠ¶æ€ç»„ä»¶ï¼‰

**ç”¨é€”**ï¼šæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯

**å±æ€§**ï¼š

| å±æ€§åç§° | ç±»å‹ | è¯´æ˜ |
|---------|------|------|
| ErrorMessage | string | é”™è¯¯æ¶ˆæ¯ |
| ShowRetry | bool | æ˜¯å¦æ˜¾ç¤ºé‡è¯•æŒ‰é’® |
| RetryCommand | ICommand | é‡è¯•å‘½ä»¤ |

## ä¸ƒã€åŠ¨ç”»ä¸è¿‡æ¸¡æ•ˆæœ

### 7.1 é¡µé¢è¿‡æ¸¡åŠ¨ç”»

**å¯¼èˆªè¿‡æ¸¡**ï¼š

| åœºæ™¯ | åŠ¨ç”»ç±»å‹ | æ—¶é•¿ | ç¼“åŠ¨å‡½æ•° |
|------|---------|------|---------|
| å‰è¿›å¯¼èˆª | ä»å³æ»‘å…¥ | 300ms | CubicEase(EaseOut) |
| åé€€å¯¼èˆª | ä»å·¦æ»‘å…¥ | 300ms | CubicEase(EaseOut) |
| åˆ·æ–° | æ·¡å…¥æ·¡å‡º | 200ms | Linear |

### 7.2 å…ƒç´ åŠ¨ç”»

**äº¤äº’åé¦ˆ**ï¼š

| æ§ä»¶ | è§¦å‘äº‹ä»¶ | åŠ¨ç”»æ•ˆæœ | è¯´æ˜ |
|------|---------|---------|------|
| Button | Hover | Scale(1.05) | è½»å¾®æ”¾å¤§ |
| Card | Hover | TranslateY(-4px) | ä¸Šæµ®æ•ˆæœ |
| Card | Hover | Shadow åŠ æ·± | é˜´å½±å¢å¼º |
| ListItem | Click | èƒŒæ™¯è‰²å˜åŒ– | ç‚¹å‡»åé¦ˆ |
| Dialog | æ‰“å¼€ | Scale(0.9 â†’ 1.0) + Fade(0 â†’ 1) | å¼¹å‡ºåŠ¨ç”» |
| Dialog | å…³é—­ | Scale(1.0 â†’ 0.9) + Fade(1 â†’ 0) | æ”¶èµ·åŠ¨ç”» |

### 7.3 æ•°æ®åŠ è½½åŠ¨ç”»

**éª¨æ¶å±**ï¼š
- åœ¨æ•°æ®åŠ è½½æ—¶æ˜¾ç¤ºå ä½ç¬¦
- ä½¿ç”¨æ¸å˜åŠ¨ç”»æ¨¡æ‹ŸåŠ è½½è¿‡ç¨‹
- åŠ è½½å®Œæˆåæ·¡å…¥çœŸå®å†…å®¹

**åˆ—è¡¨åŠ è½½**ï¼š
- ä½¿ç”¨ ItemsRepeater çš„å¢é‡åŠ è½½
- æ–°é¡¹ç›®ä»ä¸‹æ–¹æ»‘å…¥
- åˆ é™¤é¡¹ç›®æ·¡å‡º

## å…«ã€å“åº”å¼å¸ƒå±€ä¸é€‚é…

### 8.1 çª—å£å°ºå¯¸æ–­ç‚¹

| æ–­ç‚¹åç§° | å®½åº¦èŒƒå›´ | å¸ƒå±€è°ƒæ•´ |
|---------|---------|---------|
| Compact | < 640px | å•åˆ—å¸ƒå±€ï¼Œéšè—æ¬¡è¦ä¿¡æ¯ |
| Medium | 640px - 1007px | åŒåˆ—å¸ƒå±€ï¼Œä¿ç•™ä¸»è¦åŠŸèƒ½ |
| Expanded | â‰¥ 1008px | ä¸‰åˆ—å¸ƒå±€ï¼Œå®Œæ•´åŠŸèƒ½ |

### 8.2 è‡ªé€‚åº”è¡Œä¸º

**å¯¼èˆªé¢æ¿**ï¼š
- Expandedï¼šå±•å¼€æ˜¾ç¤ºæ–‡æœ¬
- Mediumï¼šä»…æ˜¾ç¤ºå›¾æ ‡
- Compactï¼šéšè—ï¼Œä½¿ç”¨æ±‰å ¡èœå•

**æ•°æ®åˆ—è¡¨**ï¼š
- Expandedï¼šç½‘æ ¼è§†å›¾ï¼ˆ3-4åˆ—ï¼‰
- Mediumï¼šç½‘æ ¼è§†å›¾ï¼ˆ2åˆ—ï¼‰
- Compactï¼šåˆ—è¡¨è§†å›¾ï¼ˆå•åˆ—ï¼‰

**è¯¦æƒ…é¢æ¿**ï¼š
- Expandedï¼šä¾§è¾¹å›ºå®šé¢æ¿
- Mediumï¼šå¯æŠ˜å é¢æ¿
- Compactï¼šå…¨å±å¯¹è¯æ¡†

## ä¹ã€æ— éšœç¢ä¸å›½é™…åŒ–

### 9.1 æ— éšœç¢è®¾è®¡

**é”®ç›˜å¯¼èˆª**ï¼š
- æ‰€æœ‰äº¤äº’å…ƒç´ æ”¯æŒ Tab é”®å¯¼èˆª
- ä½¿ç”¨ AccessKey æä¾›å¿«æ·é”®
- ç„¦ç‚¹é¡ºåºç¬¦åˆé€»è¾‘æµç¨‹

**å±å¹•é˜…è¯»å™¨æ”¯æŒ**ï¼š
- æ‰€æœ‰å›¾æ ‡æŒ‰é’®æ·»åŠ  AutomationProperties.Name
- åˆ—è¡¨é¡¹æä¾›å®Œæ•´æè¿°
- è¡¨å•å­—æ®µå…³è” Label

**å¯¹æ¯”åº¦**ï¼š
- æ–‡æœ¬ä¸èƒŒæ™¯å¯¹æ¯”åº¦ â‰¥ 4.5:1
- å¤§æ–‡æœ¬å¯¹æ¯”åº¦ â‰¥ 3:1
- ç„¦ç‚¹æŒ‡ç¤ºå™¨æ¸…æ™°å¯è§

### 9.2 å›½é™…åŒ–

**æ”¯æŒè¯­è¨€**ï¼š
- ç®€ä½“ä¸­æ–‡ï¼ˆé»˜è®¤ï¼‰
- è‹±è¯­

**èµ„æºæ–‡ä»¶ç»“æ„**ï¼š

| èµ„æºé”® | ç®€ä½“ä¸­æ–‡ | è‹±è¯­ |
|--------|---------|------|
| PersonnelPage.Title | äººå‘˜ç®¡ç† | Personnel Management |
| PersonnelPage.AddButton | æ–°å¢äººå‘˜ | Add Personnel |
| PersonnelPage.SearchPlaceholder | æœç´¢äººå‘˜å§“å | Search by name |

**æ—¥æœŸæ—¶é—´æ ¼å¼**ï¼š
- ä½¿ç”¨ç”¨æˆ·ç³»ç»Ÿçš„åŒºåŸŸè®¾ç½®
- æ—¥æœŸæ ¼å¼ï¼šyyyy-MM-dd
- æ—¶é—´æ ¼å¼ï¼šHH:mm:ss

## åã€æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### 10.1 å‰ç«¯ä¼˜åŒ–

**è™šæ‹ŸåŒ–åˆ—è¡¨**ï¼š
- ä½¿ç”¨ ItemsRepeater æ›¿ä»£ ListView
- å¯ç”¨è™šæ‹ŸåŒ–ï¼ˆVirtualizationMode="Recycling"ï¼‰
- å¤§æ•°æ®é›†ä½¿ç”¨å¢é‡åŠ è½½

**å›¾ç‰‡ä¼˜åŒ–**ï¼š
- äººå‘˜å¤´åƒä½¿ç”¨ç¼©ç•¥å›¾
- å»¶è¿ŸåŠ è½½éå¯è§å›¾ç‰‡
- ä½¿ç”¨ç¼“å­˜æœºåˆ¶

**UI çº¿ç¨‹ä¼˜åŒ–**ï¼š
- è€—æ—¶æ“ä½œä½¿ç”¨ Task.Run
- ä½¿ç”¨ Dispatcher æ›´æ–° UI
- é¿å…é˜»å¡ä¸»çº¿ç¨‹

### 10.2 API é€šä¿¡ä¼˜åŒ–

**è¯·æ±‚ä¼˜åŒ–**ï¼š
- ä½¿ç”¨åˆ†é¡µå‡å°‘å•æ¬¡æ•°æ®é‡
- åˆå¹¶å¤šä¸ªå°è¯·æ±‚
- å¯ç”¨ HTTP/2 å¤šè·¯å¤ç”¨

**ç¼“å­˜ç­–ç•¥**ï¼š

| æ•°æ®ç±»å‹ | ç¼“å­˜ç­–ç•¥ | è¿‡æœŸæ—¶é—´ |
|---------|---------|---------|
| æŠ€èƒ½åˆ—è¡¨ | æœ¬åœ°ç¼“å­˜ | 1å°æ—¶ |
| äººå‘˜åˆ—è¡¨ | å†…å­˜ç¼“å­˜ | 5åˆ†é’Ÿ |
| å“¨ä½åˆ—è¡¨ | å†…å­˜ç¼“å­˜ | 5åˆ†é’Ÿ |
| æ’ç­ç»“æœ | ä¸ç¼“å­˜ | - |

**æ•°æ®å‹ç¼©**ï¼š
- å¯ç”¨ Gzip/Brotli å‹ç¼©
- å“åº”ä½“å‹ç¼©ç‡ > 60%

### 10.3 æ•°æ®åº“ä¼˜åŒ–

**ç´¢å¼•ç­–ç•¥**ï¼š
- PersonalIdã€PositionIdã€Date å»ºç«‹ç´¢å¼•
- è”åˆç´¢å¼•ï¼š(ScheduleId, Date)
- é¿å…è¿‡åº¦ç´¢å¼•

**æŸ¥è¯¢ä¼˜åŒ–**ï¼š
- ä½¿ç”¨ EF Core çš„ AsNoTracking
- é¿å… N+1 æŸ¥è¯¢
- ä½¿ç”¨ Include é¢„åŠ è½½å…³è”æ•°æ®

## åä¸€ã€å®‰å…¨æ€§è€ƒè™‘

### 11.1 API å®‰å…¨

**èº«ä»½éªŒè¯**ï¼ˆå¯é€‰ï¼‰ï¼š
- ä½¿ç”¨ JWT Token
- Token è¿‡æœŸæ—¶é—´ï¼š1å°æ—¶
- Refresh Token æœºåˆ¶

**æ•°æ®éªŒè¯**ï¼š
- å‰ç«¯éªŒè¯ + åç«¯éªŒè¯
- ä½¿ç”¨æ•°æ®æ³¨è§£ï¼ˆDataAnnotationsï¼‰
- é˜²æ­¢ SQL æ³¨å…¥ï¼ˆä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢ï¼‰
- é˜²æ­¢ XSSï¼ˆè½¬ä¹‰ç”¨æˆ·è¾“å…¥ï¼‰

**HTTPS**ï¼š
- å¼ºåˆ¶ä½¿ç”¨ HTTPS
- ç¦ç”¨ä¸å®‰å…¨çš„ TLS ç‰ˆæœ¬
- ä½¿ç”¨æœ‰æ•ˆçš„ SSL è¯ä¹¦

### 11.2 æ•°æ®å®‰å…¨

**æ•æ„Ÿæ•°æ®**ï¼š
- æ•°æ®åº“æ–‡ä»¶åŠ å¯†ï¼ˆSQLite Encryption Extensionï¼‰
- é…ç½®æ–‡ä»¶åŠ å¯†å­˜å‚¨

**æ—¥å¿—å®‰å…¨**ï¼š
- ä¸è®°å½•æ•æ„Ÿä¿¡æ¯ï¼ˆå¯†ç ã€Tokenï¼‰
- æ—¥å¿—æ–‡ä»¶è®¿é—®æ§åˆ¶

## åäºŒã€éƒ¨ç½²ä¸é…ç½®

### 12.1 å‰ç«¯éƒ¨ç½²

**æ‰“åŒ…æ–¹å¼**ï¼š
- MSIX æ‰“åŒ…ï¼ˆMicrosoft Storeï¼‰
- ç‹¬ç«‹å®‰è£…åŒ…ï¼ˆSetup.exeï¼‰
- ä¾¿æºç‰ˆï¼ˆPortableï¼‰

**é…ç½®æ–‡ä»¶**ï¼ˆappsettings.jsonï¼‰ï¼š

| é…ç½®é¡¹ | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|--------|------|--------|
| ApiBaseUrl | API æœåŠ¡åœ°å€ | https://localhost:5001/api/v1 |
| DatabasePath | æ•°æ®åº“è·¯å¾„ | ./data/scheduling.db |
| LogLevel | æ—¥å¿—çº§åˆ« | Information |
| Theme | é»˜è®¤ä¸»é¢˜ | Light/Dark/System |

### 12.2 åç«¯éƒ¨ç½²

**éƒ¨ç½²æ–¹å¼**ï¼š
- Windows Service
- IIS æ‰˜ç®¡
- Kestrel ç‹¬ç«‹è¿è¡Œ
- Docker å®¹å™¨

**é…ç½®æ–‡ä»¶**ï¼ˆappsettings.jsonï¼‰ï¼š

| é…ç½®é¡¹ | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|--------|------|--------|
| ConnectionStrings.DefaultConnection | æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸² | Data Source=scheduling.db |
| Cors.AllowedOrigins | å…è®¸çš„è·¨åŸŸæ¥æº | ["http://localhost:3000"] |
| Jwt.Secret | JWT å¯†é’¥ | [ç”Ÿæˆçš„éšæœºå¯†é’¥] |
| Jwt.ExpirationMinutes | Token è¿‡æœŸæ—¶é—´ | 60 |

### 12.3 æ•°æ®åº“è¿ç§»

**åˆå§‹åŒ–**ï¼š
- é¦–æ¬¡è¿è¡Œè‡ªåŠ¨åˆ›å»ºæ•°æ®åº“è¡¨
- æ‰§è¡Œ EF Core Migrations

**ç‰ˆæœ¬å‡çº§**ï¼š
- ä½¿ç”¨ Migration è„šæœ¬
- å¤‡ä»½æ—§æ•°æ®
- æ‰§è¡Œå‡çº§è„šæœ¬
- éªŒè¯æ•°æ®å®Œæ•´æ€§

## åä¸‰ã€æµ‹è¯•ç­–ç•¥

### 13.1 å‰ç«¯æµ‹è¯•

**å•å…ƒæµ‹è¯•**ï¼š
- æµ‹è¯• ViewModel é€»è¾‘
- æµ‹è¯•æ•°æ®éªŒè¯
- æµ‹è¯•å‘½ä»¤æ‰§è¡Œ
- ä½¿ç”¨ xUnit + Moq

**UI æµ‹è¯•**ï¼š
- ä½¿ç”¨ WinAppDriver
- æµ‹è¯•é¡µé¢å¯¼èˆª
- æµ‹è¯•è¡¨å•æäº¤
- æµ‹è¯•æ•°æ®ç»‘å®š

### 13.2 åç«¯æµ‹è¯•

**API æµ‹è¯•**ï¼š
- ä½¿ç”¨ WebApplicationFactory
- æµ‹è¯•æ‰€æœ‰ç«¯ç‚¹
- æµ‹è¯•æ•°æ®éªŒè¯
- æµ‹è¯•é”™è¯¯å¤„ç†

**é›†æˆæµ‹è¯•**ï¼š
- æµ‹è¯•å®Œæ•´ä¸šåŠ¡æµç¨‹
- æµ‹è¯•æ•°æ®åº“æ“ä½œ
- æµ‹è¯•æ’ç­ç®—æ³•

### 13.3 æ€§èƒ½æµ‹è¯•

**è´Ÿè½½æµ‹è¯•**ï¼š
- æ¨¡æ‹Ÿå¹¶å‘è¯·æ±‚
- æµ‹è¯•å“åº”æ—¶é—´
- æµ‹è¯•ååé‡

**å‹åŠ›æµ‹è¯•**ï¼š
- æµ‹è¯•ç³»ç»Ÿä¸Šé™
- æµ‹è¯•é”™è¯¯æ¢å¤
- æµ‹è¯•èµ„æºå ç”¨
