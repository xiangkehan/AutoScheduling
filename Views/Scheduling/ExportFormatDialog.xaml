<ContentDialog
    x:Class="AutoScheduling3.Views.Scheduling.ExportFormatDialog"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Title="导出排班结果"
    PrimaryButtonText="导出"
    SecondaryButtonText="取消"
    DefaultButton="Primary"
    PrimaryButtonClick="ContentDialog_PrimaryButtonClick"
    Opened="ContentDialog_Opened"
    AutomationProperties.Name="导出排班结果对话框"
    AutomationProperties.HelpText="选择导出格式和导出选项">
    
    <!-- 键盘快捷键 -->
    <ContentDialog.KeyboardAccelerators>
        <!-- Esc: 取消对话框 -->
        <KeyboardAccelerator Key="Escape" Invoked="EscapeAccelerator_Invoked"/>
    </ContentDialog.KeyboardAccelerators>

    <StackPanel Spacing="16" MinWidth="450">
        <!-- 导出格式 -->
        <StackPanel Spacing="8">
            <TextBlock Text="选择导出格式"
                       FontSize="16"
                       FontWeight="SemiBold"
                       AutomationProperties.Name="选择导出格式标题"
                       AutomationProperties.HeadingLevel="Level2"/>

            <StackPanel Spacing="8" AutomationProperties.Name="导出格式选项组">
                <!-- Excel -->
                <RadioButton x:Name="ExcelRadioButton"
                             GroupName="ExportFormat"
                             IsChecked="True"
                             Checked="FormatRadioButton_Checked"
                             AutomationProperties.Name="Excel格式"
                             AutomationProperties.HelpText="导出为Excel文件，包含表格数据、统计信息和格式化样式"
                             ToolTipService.ToolTip="Excel (.xlsx)">
                    <StackPanel Spacing="4">
                        <StackPanel Orientation="Horizontal"
                                    Spacing="8">
                            <FontIcon Glyph="&#xF1E3;"
                                      FontSize="20"
                                      Foreground="{ThemeResource AccentFillColorDefaultBrush}"/>
                            <TextBlock Text="Excel (.xlsx)"
                                       FontWeight="Medium"
                                       VerticalAlignment="Center"/>
                        </StackPanel>
                        <TextBlock Text="包含表格数据、统计信息和格式化样式"
                                   FontSize="12"
                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                   Margin="28,0,0,0"/>
                    </StackPanel>
                </RadioButton>

                <!-- CSV -->
                <RadioButton x:Name="CsvRadioButton"
                             GroupName="ExportFormat"
                             Checked="FormatRadioButton_Checked"
                             AutomationProperties.Name="CSV格式"
                             AutomationProperties.HelpText="导出为CSV文件，纯文本格式，适合导入其他系统"
                             ToolTipService.ToolTip="CSV (.csv)">
                    <StackPanel Spacing="4">
                        <StackPanel Orientation="Horizontal"
                                    Spacing="8">
                            <FontIcon Glyph="&#xE8A5;"
                                      FontSize="20"
                                      Foreground="{ThemeResource AccentFillColorDefaultBrush}"/>
                            <TextBlock Text="CSV (.csv)"
                                       FontWeight="Medium"
                                       VerticalAlignment="Center"/>
                        </StackPanel>
                        <TextBlock Text="纯文本格式，适合导入其他系统"
                                   FontSize="12"
                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                   Margin="28,0,0,0"/>
                    </StackPanel>
                </RadioButton>

                <!-- PDF -->
                <RadioButton x:Name="PdfRadioButton"
                             GroupName="ExportFormat"
                             Checked="FormatRadioButton_Checked"
                             AutomationProperties.Name="PDF格式"
                             AutomationProperties.HelpText="导出为PDF文件，包含表格数据、统计信息和页眉页脚"
                             ToolTipService.ToolTip="PDF (.pdf)">
                    <StackPanel Spacing="4">
                        <StackPanel Orientation="Horizontal"
                                    Spacing="8">
                            <FontIcon Glyph="&#xEA90;"
                                      FontSize="20"
                                      Foreground="{ThemeResource AccentFillColorDefaultBrush}"/>
                            <TextBlock Text="PDF (.pdf)"
                                       FontWeight="Medium"
                                       VerticalAlignment="Center"/>
                        </StackPanel>
                        <TextBlock Text="包含表格数据、统计信息和页眉页脚"
                                   FontSize="12"
                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                   Margin="28,0,0,0"/>
                    </StackPanel>
                </RadioButton>
            </StackPanel>
        </StackPanel>

        <!-- 导出选项 -->
        <StackPanel Spacing="8">
            <TextBlock Text="导出选项"
                       FontSize="16"
                       FontWeight="SemiBold"
                       AutomationProperties.Name="导出选项标题"
                       AutomationProperties.HeadingLevel="Level2"/>

            <StackPanel Spacing="8">
                <!-- 包含空单元格 -->
                <CheckBox x:Name="IncludeEmptyCellsCheckBox"
                          Content="包含未分配的单元格"
                          IsChecked="True"
                          AutomationProperties.Name="包含未分配的单元格选项"
                          AutomationProperties.HelpText="在导出文件中包含未分配人员的单元格"
                          ToolTipService.ToolTip="包含未分配的单元格"/>

                <!-- 高亮冲突 -->
                <CheckBox x:Name="HighlightConflictsCheckBox"
                          Content="高亮显示冲突的单元格"
                          IsChecked="True"
                          AutomationProperties.Name="高亮显示冲突选项"
                          AutomationProperties.HelpText="在导出文件中用颜色标记有冲突的单元格"
                          ToolTipService.ToolTip="高亮显示冲突"/>

                <!-- 包含统计信息 -->
                <CheckBox x:Name="IncludeStatisticsCheckBox"
                          Content="包含统计信息"
                          IsChecked="True"
                          AutomationProperties.Name="包含统计信息选项"
                          AutomationProperties.HelpText="在导出文件中包含人员工作量和哨位覆盖率等统计信息"
                          ToolTipService.ToolTip="包含统计信息"/>

                <!-- 包含约束评分 -->
                <CheckBox x:Name="IncludeScoresCheckBox"
                          Content="包含软约束评分"
                          IsChecked="False"
                          AutomationProperties.Name="包含软约束评分选项"
                          AutomationProperties.HelpText="在导出文件中包含软约束的评分详情"
                          ToolTipService.ToolTip="包含软约束评分"/>
            </StackPanel>
        </StackPanel>

        <!-- PDF 功能提示 -->
        <InfoBar x:Name="PdfNoticeBar"
                 Severity="Informational"
                 IsOpen="False"
                 IsClosable="False"
                 Message="PDF 导出功能正在开发中，敬请期待"
                 AutomationProperties.Name="PDF功能提示"
                 AutomationProperties.LiveSetting="Polite"/>

        <!-- 验证错误提示 -->
        <InfoBar x:Name="ValidationErrorBar"
                 Severity="Error"
                 IsOpen="False"
                 IsClosable="True"
                 AutomationProperties.Name="验证错误提示"
                 AutomationProperties.LiveSetting="Assertive"/>
    </StackPanel>
</ContentDialog>
