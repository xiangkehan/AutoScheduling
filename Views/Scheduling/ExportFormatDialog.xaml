<ContentDialog
    x:Class="AutoScheduling3.Views.Scheduling.ExportFormatDialog"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Title="导出排班结果"
    PrimaryButtonText="导出"
    SecondaryButtonText="取消"
    DefaultButton="Primary"
    PrimaryButtonClick="ContentDialog_PrimaryButtonClick"
    Opened="ContentDialog_Opened">

    <StackPanel Spacing="16" MinWidth="450">
        <!-- 导出格式 -->
        <StackPanel Spacing="8">
            <TextBlock Text="选择导出格式"
                       FontSize="16"
                       FontWeight="SemiBold"/>

            <StackPanel Spacing="8">
                <!-- Excel -->
                <RadioButton x:Name="ExcelRadioButton"
                             GroupName="ExportFormat"
                             IsChecked="True"
                             Checked="FormatRadioButton_Checked">
                    <StackPanel Spacing="4">
                        <StackPanel Orientation="Horizontal"
                                    Spacing="8">
                            <FontIcon Glyph="&#xF1E3;"
                                      FontSize="20"
                                      Foreground="{ThemeResource AccentFillColorDefaultBrush}"/>
                            <TextBlock Text="Excel (.xlsx)"
                                       FontWeight="Medium"
                                       VerticalAlignment="Center"/>
                        </StackPanel>
                        <TextBlock Text="包含表格数据、统计信息和格式化样式"
                                   FontSize="12"
                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                   Margin="28,0,0,0"/>
                    </StackPanel>
                </RadioButton>

                <!-- CSV -->
                <RadioButton x:Name="CsvRadioButton"
                             GroupName="ExportFormat"
                             Checked="FormatRadioButton_Checked">
                    <StackPanel Spacing="4">
                        <StackPanel Orientation="Horizontal"
                                    Spacing="8">
                            <FontIcon Glyph="&#xE8A5;"
                                      FontSize="20"
                                      Foreground="{ThemeResource AccentFillColorDefaultBrush}"/>
                            <TextBlock Text="CSV (.csv)"
                                       FontWeight="Medium"
                                       VerticalAlignment="Center"/>
                        </StackPanel>
                        <TextBlock Text="纯文本格式，适合导入其他系统"
                                   FontSize="12"
                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                   Margin="28,0,0,0"/>
                    </StackPanel>
                </RadioButton>

                <!-- PDF -->
                <RadioButton x:Name="PdfRadioButton"
                             GroupName="ExportFormat"
                             Checked="FormatRadioButton_Checked">
                    <StackPanel Spacing="4">
                        <StackPanel Orientation="Horizontal"
                                    Spacing="8">
                            <FontIcon Glyph="&#xEA90;"
                                      FontSize="20"
                                      Foreground="{ThemeResource AccentFillColorDefaultBrush}"/>
                            <TextBlock Text="PDF (.pdf)"
                                       FontWeight="Medium"
                                       VerticalAlignment="Center"/>
                        </StackPanel>
                        <TextBlock Text="包含表格数据、统计信息和页眉页脚"
                                   FontSize="12"
                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                   Margin="28,0,0,0"/>
                    </StackPanel>
                </RadioButton>
            </StackPanel>
        </StackPanel>

        <!-- 导出选项 -->
        <StackPanel Spacing="8">
            <TextBlock Text="导出选项"
                       FontSize="16"
                       FontWeight="SemiBold"/>

            <StackPanel Spacing="8">
                <!-- 包含空单元格 -->
                <CheckBox x:Name="IncludeEmptyCellsCheckBox"
                          Content="包含未分配的单元格"
                          IsChecked="True"/>

                <!-- 高亮冲突 -->
                <CheckBox x:Name="HighlightConflictsCheckBox"
                          Content="高亮显示冲突的单元格"
                          IsChecked="True"/>

                <!-- 包含统计信息 -->
                <CheckBox x:Name="IncludeStatisticsCheckBox"
                          Content="包含统计信息"
                          IsChecked="True"/>

                <!-- 包含约束评分 -->
                <CheckBox x:Name="IncludeScoresCheckBox"
                          Content="包含软约束评分"
                          IsChecked="False"/>
            </StackPanel>
        </StackPanel>

        <!-- PDF 功能提示 -->
        <InfoBar x:Name="PdfNoticeBar"
                 Severity="Informational"
                 IsOpen="False"
                 IsClosable="False"
                 Message="PDF 导出功能正在开发中，敬请期待"/>

        <!-- 验证错误提示 -->
        <InfoBar x:Name="ValidationErrorBar"
                 Severity="Error"
                 IsOpen="False"
                 IsClosable="True"/>
    </StackPanel>
</ContentDialog>
