<ContentDialog
    x:Class="AutoScheduling3.Views.Scheduling.ConflictResolutionDialog"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:dto="using:AutoScheduling3.DTOs"
    mc:Ignorable="d"
    Title="冲突修复建议"
    PrimaryButtonText="应用方案"
    CloseButtonText="取消"
    DefaultButton="Primary"
    PrimaryButtonClick="OnPrimaryButtonClick"
    CloseButtonClick="OnCloseButtonClick">

    <ContentDialog.Resources>
        <!-- 推荐标签样式 -->
        <Style x:Key="RecommendedBadgeStyle" TargetType="Border">
            <Setter Property="Background" Value="{ThemeResource SystemAccentColor}"/>
            <Setter Property="CornerRadius" Value="4"/>
            <Setter Property="Padding" Value="8,4"/>
            <Setter Property="Margin" Value="8,0,0,0"/>
        </Style>
    </ContentDialog.Resources>

    <ScrollViewer MaxHeight="600" VerticalScrollBarVisibility="Auto">
        <StackPanel Spacing="16">
            <!-- 冲突详情 -->
            <Border 
                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                BorderThickness="1"
                CornerRadius="8"
                Padding="16">
                <StackPanel Spacing="8">
                    <TextBlock 
                        Text="冲突详情" 
                        Style="{StaticResource SubtitleTextBlockStyle}"
                        FontWeight="SemiBold"/>
                    
                    <Grid ColumnSpacing="16" RowSpacing="8">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" Grid.Column="0" Text="类型:" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                        <TextBlock Grid.Row="0" Grid.Column="1" x:Name="ConflictTypeText" FontWeight="SemiBold"/>

                        <TextBlock Grid.Row="1" Grid.Column="0" Text="人员:" Foreground="{ThemeResource TextFillColorSecondaryBrush}" x:Name="PersonnelLabel"/>
                        <TextBlock Grid.Row="1" Grid.Column="1" x:Name="PersonnelText"/>

                        <TextBlock Grid.Row="2" Grid.Column="0" Text="哨位:" Foreground="{ThemeResource TextFillColorSecondaryBrush}" x:Name="PositionLabel"/>
                        <TextBlock Grid.Row="2" Grid.Column="1" x:Name="PositionText"/>

                        <TextBlock Grid.Row="3" Grid.Column="0" Text="时间:" Foreground="{ThemeResource TextFillColorSecondaryBrush}" x:Name="TimeLabel"/>
                        <TextBlock Grid.Row="3" Grid.Column="1" x:Name="TimeText"/>

                        <TextBlock Grid.Row="4" Grid.Column="0" Text="问题:" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                        <TextBlock Grid.Row="4" Grid.Column="1" x:Name="ProblemText" TextWrapping="Wrap"/>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- 修复方案列表 -->
            <StackPanel Spacing="8">
                <TextBlock 
                    Text="修复方案" 
                    Style="{StaticResource SubtitleTextBlockStyle}"
                    FontWeight="SemiBold"/>
                
                <ItemsControl x:Name="ResolutionOptionsItemsControl">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate x:DataType="dto:ConflictResolutionOption">
                            <RadioButton 
                                GroupName="ResolutionOptions"
                                Margin="0,8,0,0"
                                IsChecked="{x:Bind IsRecommended, Mode=OneWay}">
                                <RadioButton.Content>
                                    <Border 
                                        Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                        BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                        BorderThickness="1"
                                        CornerRadius="8"
                                        Padding="16"
                                        MinWidth="500">
                                        <StackPanel Spacing="12">
                                            <!-- 方案标题 -->
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock 
                                                    Text="{x:Bind Title}" 
                                                    FontWeight="SemiBold"
                                                    FontSize="14"/>
                                                <Border 
                                                    Style="{StaticResource RecommendedBadgeStyle}"
                                                    Visibility="{x:Bind IsRecommended}">
                                                    <TextBlock 
                                                        Text="推荐" 
                                                        FontSize="12"
                                                        Foreground="White"/>
                                                </Border>
                                            </StackPanel>

                                            <!-- 方案描述 -->
                                            <TextBlock 
                                                Text="{x:Bind Description}" 
                                                Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                                TextWrapping="Wrap"/>

                                            <!-- 优点 -->
                                            <ItemsControl ItemsSource="{x:Bind Pros}">
                                                <ItemsControl.ItemTemplate>
                                                    <DataTemplate x:DataType="x:String">
                                                        <StackPanel Orientation="Horizontal" Margin="0,2">
                                                            <FontIcon 
                                                                Glyph="&#xE73E;" 
                                                                FontSize="12"
                                                                Foreground="#10893E"
                                                                Margin="0,0,8,0"/>
                                                            <TextBlock 
                                                                Text="{x:Bind}" 
                                                                Foreground="#10893E"
                                                                FontSize="12"/>
                                                        </StackPanel>
                                                    </DataTemplate>
                                                </ItemsControl.ItemTemplate>
                                            </ItemsControl>

                                            <!-- 缺点 -->
                                            <ItemsControl ItemsSource="{x:Bind Cons}">
                                                <ItemsControl.ItemTemplate>
                                                    <DataTemplate x:DataType="x:String">
                                                        <StackPanel Orientation="Horizontal" Margin="0,2">
                                                            <FontIcon 
                                                                Glyph="&#xE7BA;" 
                                                                FontSize="12"
                                                                Foreground="#F7630C"
                                                                Margin="0,0,8,0"/>
                                                            <TextBlock 
                                                                Text="{x:Bind}" 
                                                                Foreground="#F7630C"
                                                                FontSize="12"/>
                                                        </StackPanel>
                                                    </DataTemplate>
                                                </ItemsControl.ItemTemplate>
                                            </ItemsControl>

                                            <!-- 影响 -->
                                            <StackPanel Spacing="4">
                                                <TextBlock Text="影响:" FontSize="12" FontWeight="SemiBold"/>
                                                <TextBlock 
                                                    Text="{x:Bind Impact}" 
                                                    FontSize="12"
                                                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                                    TextWrapping="Wrap"/>
                                            </StackPanel>
                                        </StackPanel>
                                    </Border>
                                </RadioButton.Content>
                            </RadioButton>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>

                <!-- 无可用方案提示 -->
                <Border 
                    x:Name="NoOptionsPanel"
                    Visibility="Collapsed"
                    Background="{ThemeResource SystemFillColorCautionBackgroundBrush}"
                    BorderBrush="{ThemeResource SystemFillColorCautionBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="16">
                    <StackPanel Spacing="8" Orientation="Horizontal">
                        <FontIcon 
                            Glyph="&#xE7BA;" 
                            Foreground="{ThemeResource SystemFillColorCautionBrush}"/>
                        <TextBlock 
                            Text="暂无可用的自动修复方案，请手动调整排班。"
                            TextWrapping="Wrap"
                            VerticalAlignment="Center"/>
                    </StackPanel>
                </Border>
            </StackPanel>
        </StackPanel>
    </ScrollViewer>
</ContentDialog>
